<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
  <title>Chrome Developers</title>
  <subtitle>Build the next generation of web experiences.</subtitle>
  <link href="https://developer.chrome.com/feeds/all.xml" rel="self"/>
  <link href="https://developer.chrome.com" />
  
    <updated>2023-03-02T00:00:00Z</updated>
  
  <id>https://developer.chrome.com</id>
  <author>
    <name>Chrome Developers</name>
  </author>
  
  
  <entry>
    <title>Privacy win! Users now share their screens more wisely</title>
    <link href="https://developer.chrome.com/en/blog/media-picker-reorder/" />
    <updated>2023-03-02T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/media-picker-reorder/</id>
    
      
      
      <author>
        <name>beaufortfrancois</name>
      </author>
      
      
      <author>
        <name>eladalon</name>
      </author>
      
    
    <content type="html">&lt;p&gt;The web platform allows users to share their screen using the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Screen_Capture_API&quot;&gt;Screen Capture API&lt;/a&gt;. Chrome’s implementation of &lt;a href=&quot;https://developer.mozilla.org/docs/web/api/mediadevices/getdisplaymedia&quot;&gt;&lt;code&gt;getDisplayMedia()&lt;/code&gt;&lt;/a&gt; includes a media picker through which users may choose to share any tab, window, or screen. Starting with Chrome 107, we experimented with a small modification of that dialog, putting tabs as the first option, to encourage users to share tabs and away from sharing their entire screen. This relies on the well-understood concept that the way a question is phrased influences the distribution of answers. This is known colloquially as Nudge Theory, and known to children as “pretty please.” After some initial bumps, the experiment proved to be a great success, and we have now shipped this new experience to all users.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Screenshots of the old and new media picker prompts.&quot; decoding=&quot;async&quot; height=&quot;439&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/ms7aIpxAOoC0ytp3iICU.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    Chrome’s media picker (the new version on top).
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As &lt;a href=&quot;https://developer.chrome.com/blog/avoiding-oversharing-when-screen-sharing/#reordering&quot;&gt;previously discussed&lt;/a&gt;, sharing tabs is usually the superior option:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Better for privacy, as users are far less likely to expose private information from other apps, notifications, desktop wallpaper, or settings.&lt;/li&gt;
&lt;li&gt;Better use of screen real-estate on the receiving side.&lt;/li&gt;
&lt;li&gt;Better utilization of network resources due to sharing less pixels.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We therefore experimented with presenting tabs as the first option.&lt;/p&gt;
&lt;p&gt;The initial roll-out of the experiment uncovered an unfortunate side-effect—by placing tabs first, the rate at which the users were choosing the current tab increased. For many applications, arguably even most, this is not desirable. For instance, in video-conferencing applications, this produces the &amp;quot;hall of mirrors&amp;quot; effect, confusing remote participants and derailing calls. We therefore paused the experiment.&lt;/p&gt;
&lt;p&gt;Luckily, from Chrome 107 the &lt;a href=&quot;https://developer.chrome.com/docs/web-platform/screen-sharing-controls/#selfBrowserSurface&quot;&gt;&lt;code&gt;selfBrowserSurface&lt;/code&gt;&lt;/a&gt; option is available. This option enables the app to dictate whether Chrome should include or exclude the current tab from the list of tabs offered to the user. As this is a new control, the vast majority of web apps do not provide an explicit value here. In the renewed experiment, starting with Chrome 108, we switched the default value from &lt;code&gt;&amp;quot;include&amp;quot;&lt;/code&gt; to &lt;code&gt;&amp;quot;exclude&amp;quot;&lt;/code&gt;. This eliminated the undesirable effect, while still allowing specialized apps to invoke the previous behavior.&lt;/p&gt;
&lt;p&gt;The change of default value as part of the experiment introduced its own benefits—self-capture dropped from around 0.8% of capture-sessions down to nearly 0%, eliminating nearly all cases of such self-sabotage, which previously affected nearly 1 out of every 100 users.&lt;/p&gt;
&lt;p&gt;The experiment resumed in Chrome 108. Once it reached 50% of users, we observed the following results:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tab sharing increased from 16% to 30%.&lt;/li&gt;
&lt;li&gt;Window sharing increased from 14% to 20%.&lt;/li&gt;
&lt;li&gt;Screen sharing decreased from 55% to 36%.&lt;/li&gt;
&lt;li&gt;Self capture (tab based) decreased from 0.8% to 0%.&lt;/li&gt;
&lt;li&gt;Cancellations increased by a varying amount; more on that below.&lt;/li&gt;
&lt;li&gt;Activations (number of calls to &lt;code&gt;getDisplayMedia()&lt;/code&gt;) increased by a varying amount.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Observed changes in users&amp;#x27; interaction with the dialog.&quot; decoding=&quot;async&quot; height=&quot;483&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/epS3f6YgxOnpUNETtFKB.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    Observed changes in users&#39; interaction with the dialog.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;We were extremely pleased with the changes to the frequency with which users share tabs, windows, and screens. But the changes in cancellations and activations was a potential cause for concern.&lt;/p&gt;
&lt;p&gt;By running the experiment for longer, we noticed that the number of cancellations in the experiment group regressed towards that of the control group. This correlated with our theory that users were bailing out as soon as they saw an unfamiliar dialog, then got used to it over time.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;The increase in cancellations in the test group petered out over time.&quot; decoding=&quot;async&quot; height=&quot;327&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/vvhSqZboQoZZN9wBvoXq72wzGAf1/pyCCIPryRLD5uhFo8twK.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    The increase in cancellations in the test group petered out over time.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The increase in activations could only be partially explained by the above theory, because the numbers don’t add up, and because the number of activations remained higher in the test group. The likely explanation for the increase in activations is that when users shared the entire screen, they never needed to stop and restart capture in order to start sharing something else. Now that they were sharing tabs and windows more often, the necessity to restart the capture arose more often. We hope to make further improvements here in the future by allowing more seamless transitions between capturing different surfaces.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Tether elements to each other with CSS anchor positioning</title>
    <link href="https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/" />
    <updated>2023-03-01T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/</id>
    
      
      
      <author>
        <name>jheyy</name>
      </author>
      
    
    <content type="html">&lt;p&gt;How do you currently tether one element to another? You might try tracking their positions, or use some form of wrapper element.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;&amp;lt;!-- index.html --&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/link&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;I’m the anchor&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchored&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;I’m the anchored thing&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* styles.css */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.container&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; relative&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.anchored&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These solutions often aren&#39;t ideal. They need JavaScript or introduce extra markup. The CSS anchor positioning API aims to solve this by providing a CSS API for tethering elements. It provides a means to position and size one element based on the position and size of other elements.&lt;/p&gt;
&lt;img alt=&quot;Image shows a mockup browser window detailing the anatomy of a tooltip.&quot; decoding=&quot;async&quot; height=&quot;582&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 664px) 664px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/ZrBRrAMuhnkvS0EOqx4j.png?auto=format&amp;w=1328 1328w&quot; width=&quot;664&quot; /&gt;
&lt;h2 id=&quot;browser-support&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#browser-support&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Browser support&lt;/h2&gt;
&lt;p&gt;You can try out the CSS anchor positioning API in Chrome Canary behind the &amp;quot;Experimental Web Platform Features&amp;quot; flag. To enable that flag, open Chrome Canary and visit &lt;code&gt;chrome://flags&lt;/code&gt;. Then enable the &amp;quot;Experimental web platform features&amp;quot; flag.&lt;/p&gt;
&lt;p&gt;There is also a &lt;a href=&quot;https://github.com/oddbird/css-anchor-positioning&quot;&gt;polyfill in development&lt;/a&gt; by the team at Oddbird. Be sure to check the repo at &lt;a href=&quot;https://github.com/oddbird/css-anchor-positioning&quot;&gt;github.com/oddbird/css-anchor-positioning&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can check for anchoring support with:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@supports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --foo&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* Styles... */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that this API is still in an experimental stage and could change. This article covers the important parts at a high level. The current implementation also isn&#39;t completely in sync with the &lt;a href=&quot;https://drafts.csswg.org/css-anchor-position-1&quot;&gt;CSS Working Group spec&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-problem&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#the-problem&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; The problem&lt;/h2&gt;
&lt;p&gt;Why would you need to do this? A prominent use case would be creating tooltips or tooltip-like experiences. In that case, you often want to tether the tooltip to the content that it references. There is often a need for some way to tether an element to another. You also expect that interacting with the page doesn&#39;t break that tether—for example, if a user scrolls or resizes the UI.&lt;/p&gt;
&lt;p&gt;Another part of the problem is if you want to make sure the tethered element remains in view—for example, if you open a tooltip and it becomes clipped by the viewport bounds. This might not be a great experience for users. You&#39;d like the tooltip to adapt.&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/QY3hWeUGzMzkubWYcxAW.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;current-solutions&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#current-solutions&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Current solutions&lt;/h2&gt;
&lt;p&gt;Currently, there are some different ways you could approach the issue.&lt;/p&gt;
&lt;p&gt;First up is the rudimentary &amp;quot;Wrap the anchor&amp;quot; approach. You take both elements and wrap them in a container. Then you can use &lt;code&gt;position&lt;/code&gt; to position the tooltip relative to the anchor.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;containing-block&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;tooltip&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Anchor me!&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;The anchor&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.containing-block&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; relative&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.tooltip&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;100% + 10px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-50%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/MWGJmOG?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen MWGJmOG by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;You can move the container and everything will stay where you want it for the most part.&lt;/p&gt;
&lt;p&gt;Another approach might be if you know the position of your anchor or you can somehow track it. You could pass it to your tooltip with custom properties.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;tooltip&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Anchor me!&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;The anchor&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--anchor-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 120px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--anchor-top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 40vh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--anchor-left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 20vmin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.anchor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.tooltip&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * 0.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-50%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-100% - 10px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/NWMdwLe?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen NWMdwLe by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;But, what if you don&#39;t know the position of your anchor? You likely need to intervene with JavaScript. You could do something like the following code does, but now this means your styles are starting to leak out of CSS and into JavaScript.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;setAnchorPosition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;anchored&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; bounds &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; anchor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBoundingClientRect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toJSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;entries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bounds&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    anchored&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;style&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;key&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;update&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;setAnchorPosition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.tooltip&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.anchor&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;resize&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; update&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;DOMContentLoaded&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; update&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/rNvjYPx?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen rNvjYPx by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;This starts to pose some questions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When do I calculate the styles?&lt;/li&gt;
&lt;li&gt;How do I calculate the styles?&lt;/li&gt;
&lt;li&gt;How often do I calculate the styles?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Does that solve it? It might for your use case, but there&#39;s one issue: our solution doesn&#39;t adapt. It isn&#39;t responsive. What if my anchored element gets cut off by the viewport?&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/EUJbKfz96mOE8iNfSjcz.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;Now you need to decide whether to react to this and how. The number of questions and decisions you need to make is starting to grow. All you want to do is anchor one element to another. And in an ideal world, your solution will adjust and react to its surroundings.&lt;/p&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;The decisions you make will have to take CSS behavior into account too,  such as how containing blocks behave. This is something the &lt;a href=&quot;https://developer.chrome.com/blog/pop-ups-theyre-making-a-resurgence/&quot;&gt;Popover API&lt;/a&gt; and &lt;a href=&quot;https://developer.chrome.com/blog/what-is-the-top-layer/&quot;&gt;top layer&lt;/a&gt; access will help with.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;To ease some of that pain, you might reach for a JavaScript solution to help you out. That will incur the cost of adding a dependency to your project, and it could introduce performance issues depending on how you use them. For example, some packages use &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame&quot;&gt;&lt;code&gt;requestAnimationFrame&lt;/code&gt;&lt;/a&gt; to keep the position correct. This means you and your team need to get familiar with the package and its configuration options. As a result, your questions and decisions may not get reduced, but changed instead. This is part of the &amp;quot;why&amp;quot; for CSS anchor positioning. It will abstract you away from thinking about performance issues when calculating position.&lt;/p&gt;
&lt;p&gt;Here&#39;s what the code could look like for using &amp;quot;&lt;a href=&quot;https://floating-ui.com/&quot;&gt;floating-ui&lt;/a&gt;&amp;quot;, a popular package for this problem:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;computePosition&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; flip&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; offset&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; autoUpdate&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1/+esm&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; anchor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.anchor&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; tooltip &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.tooltip&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;updatePosition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;  &lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;computePosition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; tooltip&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token literal-property property&quot;&gt;placement&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;top&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token literal-property property&quot;&gt;middleware&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;flip&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;assign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tooltip&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;style&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token literal-property property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;x&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token literal-property property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;y&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; clean &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;autoUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; tooltip&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; updatePosition&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Try re-positioning the anchor in this demo that uses that code.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/wvEaOrP?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen wvEaOrP by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;The &amp;quot;tooltip&amp;quot; might not behave how you expect. It reacts to going outside of the viewport on the y-axis but not the x-axis. Dig into the &lt;a href=&quot;https://floating-ui.com/docs/flip&quot;&gt;documentation&lt;/a&gt;, and you’ll likely find a solution that works for you.&lt;/p&gt;
&lt;p&gt;But, finding a package that works for your project can take a lot of time. It&#39;s extra decisions and can be frustrating if it doesn&#39;t quite work how you want.&lt;/p&gt;
&lt;h2 id=&quot;using-anchor-positioning&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#using-anchor-positioning&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Using anchor positioning&lt;/h2&gt;
&lt;p&gt;Enter the CSS anchor positioning API. The idea is to keep your styles in your CSS and reduce the number of decisions you need to make. You&#39;re hoping to achieve the same result, but the goal is to make the developer experience better.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;No JavaScript required.&lt;/li&gt;
&lt;li&gt;Let the browser work out the best position from your guidance.&lt;/li&gt;
&lt;li&gt;No more third party dependencies&lt;/li&gt;
&lt;li&gt;No wrapper elements.&lt;/li&gt;
&lt;li&gt;Works with elements that are in the top layer.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let&#39;s recreate and tackle the problem we were trying to solve above. But, instead, use the analogy of a boat with an anchor. These represent the anchored element and anchor. The water represents the containing block.&lt;/p&gt;
&lt;p&gt;First, you need to choose how to define the anchor. You can do this within your CSS by setting the &lt;code&gt;anchor-name&lt;/code&gt; property on the anchor element. It accepts a &lt;a href=&quot;https://drafts.csswg.org/css-values-4/#typedef-dashed-ident&quot;&gt;dashed-ident&lt;/a&gt; value.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.anchor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Alternatively, you will be able to define an anchor in your HTML with the &lt;code&gt;anchor&lt;/code&gt; attribute. The attribute value is the ID of the anchor element. This creates an implicit anchor.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;my-anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;my-anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;boat&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;I’m a boat!&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Once you&#39;ve defined an anchor, you can use the &lt;code&gt;anchor&lt;/code&gt; function. The &lt;code&gt;anchor&lt;/code&gt; function takes 3 arguments:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Anchor element:&lt;/strong&gt; The &lt;code&gt;anchor-name&lt;/code&gt; of the anchor to use—or, you can omit the value to use an &lt;code&gt;implicit&lt;/code&gt; anchor. It can be defined via the HTML relationship, or with an &lt;code&gt;anchor-default&lt;/code&gt; property with an &lt;code&gt;anchor-name&lt;/code&gt; value.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Anchor side:&lt;/strong&gt; A keyword of the position you want to use. This could be &lt;code&gt;top&lt;/code&gt;, &lt;code&gt;right&lt;/code&gt;, &lt;code&gt;bottom&lt;/code&gt;, &lt;code&gt;left&lt;/code&gt;, &lt;code&gt;center&lt;/code&gt;, etc. Or, you can pass a percentage. For example, 50% would be equal to &lt;code&gt;center&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Fallback:&lt;/strong&gt; This is an optional fallback value that accepts a length or percentage.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You use the &lt;code&gt;anchor&lt;/code&gt; function as a value for the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/inset&quot;&gt;inset properties&lt;/a&gt; (&lt;code&gt;top&lt;/code&gt;, &lt;code&gt;right&lt;/code&gt;, &lt;code&gt;bottom&lt;/code&gt;, &lt;code&gt;left&lt;/code&gt;, or their logical equivalents) of the anchored element. You can also use the &lt;code&gt;anchor&lt;/code&gt; function in &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/calc&quot;&gt;&lt;code&gt;calc&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--my-anchor top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--my-anchor center&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--boat-size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * 0.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt; &lt;span class=&quot;token comment&quot;&gt;/* alternative with anchor-default */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;center&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--boat-size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * 0.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There is no &lt;code&gt;center&lt;/code&gt; inset property so one option is to use &lt;code&gt;calc&lt;/code&gt; if you know the size of your anchored element. Why not use &lt;code&gt;translate&lt;/code&gt;? You could use this:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;center&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; -50% 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But, the browser doesn&#39;t take into consideration transformed positions for anchored elements. It&#39;ll become clear why this is important when considering position fallbacks and auto positioning.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/YzOXMYa?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen YzOXMYa by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;At the time of writing, defining &lt;code&gt;anchor-name&lt;/code&gt; with the &lt;code&gt;anchor&lt;/code&gt; attribute isn’t implemented for non-Popover elements. Here’s &lt;a href=&quot;https://codepen.io/web-dot-dev/pen/PodqgQx&quot;&gt;a demo&lt;/a&gt; that should work soon.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;You may have noticed the use of the custom property &lt;code&gt;--boat-size&lt;/code&gt; above. But, if you want to base the anchored element size on that of the anchor, you can also access that size. Instead of calculating it yourself, you can use the &lt;code&gt;anchor-size&lt;/code&gt; function. For example, to make our boat four times the width of our anchor:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;4 * &lt;span class=&quot;token function&quot;&gt;anchor-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--my-anchor width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You also have access to the height too with &lt;code&gt;anchor-size(--my-anchor height)&lt;/code&gt;. And you can use it to set the size of either axis or both.&lt;/p&gt;
&lt;p&gt;What if you want to anchor to an element with &lt;code&gt;absolute&lt;/code&gt; positioning? The rule is that the elements can&#39;t be siblings. In that case, you can wrap the anchor with a container that has &lt;code&gt;relative&lt;/code&gt; positioning. Then you can anchor to it.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor-wrapper&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;my-anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;anchor&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;boat&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;I’m a boat!&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Check out this demo where you can drag the anchor around and the boat will follow.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/MWqbZEE?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen MWqbZEE by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/BEVLLoacjfN2GRUvUvJ7.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;tracking-scroll-position&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#tracking-scroll-position&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Tracking scroll position&lt;/h2&gt;
&lt;p&gt;In some cases, your anchor element might be within a scrolling container. At the same time, your anchored element might be outside that container. Because scrolling happens on a different thread from layout, you need a way to track it. The &lt;code&gt;anchor-scroll&lt;/code&gt; property can do this. You set it on the anchored element and give it the value of the anchor you want to track.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;anchor-scroll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Try this demo where you can switch &lt;code&gt;anchor-scroll&lt;/code&gt; on and off with the checkbox in the corner.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/XWPXLzB?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen XWPXLzB by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/yM6QGl6ZG99cMGCu3lAw.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The analogy falls a little flat here though, as in an ideal world, your boat and anchor are both in the water. Also, features such as the Popover API promote being able to keep related elements close. Anchor positioning will work with elements that are in the top layer though. This is one of the major benefits behind the API: being able to tether elements in different flows.&lt;/p&gt;
&lt;p&gt;Consider this demo that has a scrolling container with anchors that have tooltips. The tooltip elements that are popovers might not be co-located with the anchors:&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/gOzOKZL?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen gOzOKZL by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/X79WdPJ5bZDXhJ3Fw7Ti.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;But, you&#39;ll notice how the popovers track their respective anchor links. You can resize that scrolling container and the positions will update for you.&lt;/p&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;An anchored element can&#39;t detect when a tracked anchor goes outside the scroll window. But, it will still track the anchor position. There is no current way to clip the anchored element when the anchor element goes out of view.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;aside aside--warning&quot;&gt;&lt;div class=&quot;aside__label gap-bottom-300&quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M23 21L12 2 1 21h22zm-12-3v-2h2v2h-2zm0-4h2v-4h-2v4z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;span&gt;Warning&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;Features such as &lt;code&gt;anchor-size&lt;/code&gt; and &lt;code&gt;anchor-scroll&lt;/code&gt; are still in development. They could change based on your input from trying out the API.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;position-fallback-and-auto-positioning&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#position-fallback-and-auto-positioning&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Position fallback and auto positioning&lt;/h2&gt;
&lt;p&gt;This is where anchor positioning power goes up a level. A &lt;code&gt;position-fallback&lt;/code&gt; can position your anchored element based on a set of fallbacks you provide. You guide the browser with your styles and let it work out the position for you.&lt;/p&gt;
&lt;p&gt;The common use case here is a tooltip that should flip between getting shown above or below an anchor. And this behavior is based on whether the tooltip would get clipped by its container. That container is usually the viewport.&lt;/p&gt;
&lt;p&gt;If you dug into the code of the last demo, you&#39;d have seen there was a &lt;code&gt;position-fallback&lt;/code&gt; property in use. If you scrolled the container you may have noticed those anchored popovers jumped. This happened when their respective anchors neared the viewport boundary. At that moment, the popovers are trying to adjust to stay in the viewport.&lt;/p&gt;
&lt;p&gt;Before creating an explicit &lt;code&gt;position-fallback&lt;/code&gt;, anchor positioning will also offer &lt;a href=&quot;https://drafts.csswg.org/css-anchor-position-1/#automatic-anchor-positioning&quot;&gt;automatic positioning&lt;/a&gt;. You can get that flip for free by using a value of &lt;code&gt;auto&lt;/code&gt; in both the anchor function and the opposite inset property. For example, if you use &lt;code&gt;anchor&lt;/code&gt; for &lt;code&gt;bottom&lt;/code&gt;, set &lt;code&gt;top&lt;/code&gt; to &lt;code&gt;auto&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.tooltip&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--my-anchor auto&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; auto&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;This &lt;a href=&quot;https://codepen.io/web-dot-dev/pen/RwYRLXe&quot;&gt;demo&lt;/a&gt; uses auto positioning syntax. At the time of writing this isn’t implemented. Be sure to check out &lt;a href=&quot;https://drafts.csswg.org/css-anchor-position-1/#automatic-anchor-positioning&quot;&gt;the spec&lt;/a&gt; for the rules around &lt;a href=&quot;https://drafts.csswg.org/css-anchor-position-1/#automatic-anchor-positioning&quot;&gt;automatic positioning&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The alternative to auto positioning is to use an explicit &lt;code&gt;position-fallback&lt;/code&gt;. This requires you to define a position fallback set. The browser will go through these until it finds one it can use and then apply that positioning. If it can&#39;t find one that works, it defaults to the first one defined.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;position-fallback&lt;/code&gt; that tries to display the tooltips above then below could look like this:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@position-fallback&lt;/span&gt; --top-to-bottom&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;center&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;center&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Applying that to the tooltips looks like this:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.tooltip&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position-fallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --top-to-bottom&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The use of &lt;code&gt;anchor-default&lt;/code&gt; means you can reuse the &lt;code&gt;position-fallback&lt;/code&gt; for other elements. You could also use a scoped custom property to set &lt;code&gt;anchor-default&lt;/code&gt;.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/RwYRjwq?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen RwYRjwq by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/WLqBj8Qn4gBuLwMXnR2A.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;Be mindful that some user agent styles may set inset properties for you. In these cases, you may want to unset these before defining a &lt;code&gt;position-fallback&lt;/code&gt;. One example is elements using the &lt;code&gt;popover&lt;/code&gt; attribute. Applying &lt;code&gt;inset: unset;&lt;/code&gt; will work.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Consider this demo using the boat again. There is a &lt;code&gt;position-fallback&lt;/code&gt; set. As you change the position of the anchor, the boat will adjust to remain within the container. Try changing the padding value too which adjusts the body padding. Notice how the browser corrects positioning. The positions are being changed by changing the grid alignment of the container.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/RwywJJr?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen RwywJJr by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/lX3dpMcHTCEkmtdsuPTw.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;position-fallback&lt;/code&gt; is more verbose this time trying positions in a clockwise direction.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.boat&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --my-anchor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position-fallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --compass&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@position-fallback&lt;/span&gt; --compass&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;examples&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#examples&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Examples&lt;/h2&gt;
&lt;p&gt;Now you have an idea of the main features for anchor positioning, let&#39;s take a look at some interesting examples beyond tooltips. These examples aim to get your ideas flowing for ways in which you could use anchor positioning. The best way to take the spec further is with input from real users like you.&lt;/p&gt;
&lt;h3 id=&quot;context-menus&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#context-menus&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Context menus&lt;/h3&gt;
&lt;p&gt;Let&#39;s start with a context menu using the Popover API. The idea is that clicking the button with the chevron will reveal a context menu. And that menu will have its own menu to expand.&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/xzopOwuqLiKoUCxoEHAc.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The markup isn&#39;t the important part here. But, you have three buttons each using &lt;code&gt;popovertarget&lt;/code&gt;. Then you have three elements using the &lt;code&gt;popover&lt;/code&gt; attribute. That gives you the ability to open the context menus without any JavaScript. That could look like this:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popovertarget&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  Toggle Menu&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;        &lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popover&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;auto&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;ul&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Save to your Liked Songs&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popovertarget&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;playlist&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;        Add to Playlist&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popovertarget&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;share&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;        Share&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;ul&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popover&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;auto&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;share&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;...&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popover&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;auto&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;playlist&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;...&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;The nested context menus won&#39;t close the parent one because they&#39;re &lt;a href=&quot;https://developer.chrome.com/blog/pop-ups-theyre-making-a-resurgence/#types-of-popover&quot;&gt;ancestral popovers&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Now, you can define a &lt;code&gt;position-fallback&lt;/code&gt; and share it between the context menus. We make sure to unset any &lt;code&gt;inset&lt;/code&gt; styles for the popovers too.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[popovertarget=&quot;share&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --share&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;[popovertarget=&quot;playlist&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --playlist&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;[popovertarget=&quot;context&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --context&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;#share&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --share&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position-fallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --aligned&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;#playlist&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --playlist&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position-fallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --aligned&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;#context&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --context&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position-fallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --flip&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@position-fallback&lt;/span&gt; --aligned&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@position-fallback&lt;/span&gt; --flip&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@try&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This gives you &lt;a href=&quot;https://twitter.com/jh3yy/status/1625550575482900493&quot;&gt;an adaptive nested context menu UI&lt;/a&gt;. Try changing the content position with the select. The option you choose updates grid alignment. And that affects how anchor positioning positions the popovers.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/oNPzgaX?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen oNPzgaX by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;focus-and-follow&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#focus-and-follow&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Focus and follow&lt;/h3&gt;
&lt;p&gt;This demo combines CSS primitives by bringing in &lt;a href=&quot;https://developer.chrome.com/blog/has-m105/&quot;&gt;:has()&lt;/a&gt;. The idea is to &lt;a href=&quot;https://twitter.com/jh3yy/status/1590100728873615361?s=20&quot;&gt;transition a visual indicator&lt;/a&gt; for the &lt;code&gt;input&lt;/code&gt; that has focus.&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/nDrl4SxEttGRuRdRgPJ0.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;Do this by setting a new anchor at runtime. For this demo, a scoped custom property gets updated on input focus.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;#email&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --email&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;#name&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;#password&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --password&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;:root:has(#email:focus)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --email&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;:root:has(#name:focus)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;:root:has(#password:focus)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --password&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-anchor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--active-top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-anchor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; +&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;          &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;              &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-anchor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; -&lt;br /&gt;                &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-anchor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * 0.5&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.form-indicator&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--active-top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; all 0.2s&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But, how might you take this further? You could use it for some form of instructional overlay. A tooltip could move between points of interest and update its content. You could crossfade the content. Discrete animations allowing you to &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues/6429#issuecomment-1332439874&quot;&gt;animate &lt;code&gt;display&lt;/code&gt;&lt;/a&gt; or &lt;a href=&quot;https://developer.chrome.com/docs/web-platform/view-transitions/&quot;&gt;View Transitions&lt;/a&gt; could work here.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/qBMaOeL?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen qBMaOeL by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;bar-chart-calc&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#bar-chart-calc&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Bar chart calc&lt;/h3&gt;
&lt;p&gt;Another fun thing you can do with anchor positioning is combine it with &lt;code&gt;calc&lt;/code&gt;. Imagine a chart where you have some popovers that annotate the chart.&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/FBeKwXXe4nrabs2rtIUw.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;You could track the highest and lowest values using CSS &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/min&quot;&gt;&lt;code&gt;min&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/max&quot;&gt;&lt;code&gt;max&lt;/code&gt;&lt;/a&gt;. The CSS for that could look something like this:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.chart__tooltip--max&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--chart right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-1 top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-2 top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--anchor-3 top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0 50%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There is some JavaScript at play to update the chart values and some CSS to style the chart. But anchor positioning takes care of the layout updates for us.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/PoeNKXJ?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen PoeNKXJ by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;resize-handles&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#resize-handles&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Resize Handles&lt;/h3&gt;
&lt;p&gt;You don&#39;t have to only anchor to one element. You could use many anchors for an element. You might have noticed that in the bar chart example. The tooltips were anchored to the chart and then the appropriate bar. If you took that concept a little further you could use it to resize elements.&lt;/p&gt;
&lt;p&gt;&lt;video controls=&quot;&quot; loop=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/Dyx9FwYgMyNqy1kMGx8Orz6q0qC3/3M06kDhYPgT3ZKBuhUFR.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;You could treat the anchor points like custom resize handles and lean into an &lt;code&gt;inset&lt;/code&gt; value.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.container&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token property&quot;&gt;inset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--handle-1 top&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--handle-2 right&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--handle-2 bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--handle-1 left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this demo, GreenSock Draggable makes the handles Draggable. But, the &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; element resizes to fill the container that adjusts to fill the gap between the handles.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/ZEMpBzP?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen ZEMpBzP by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;a-selectmenu&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#a-selectmenu&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; A SelectMenu?&lt;/h3&gt;
&lt;p&gt;This last one&#39;s a bit of a tease for what&#39;s to come. But, you can create a focusable popover and now you have anchor positioning. You could create the foundations of a styleable &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;select-menu&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popovertarget&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;listbox&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt; Select option&lt;br /&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;...&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;popover&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;auto&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;listbox&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;A&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Styled&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Select&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;An implicit &lt;code&gt;anchor&lt;/code&gt; will make this easier. But, the CSS for a rudimentary starting point could look like this:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[popovertarget]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token property&quot;&gt;anchor-name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --select-button&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;[popover]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;anchor-default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; --select-button&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;anchor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;left&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Combine the features of the Popover API with CSS Anchor positioning and you’re close.&lt;/p&gt;
&lt;div style=&quot;height: 450px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/wvEzJeg?height=450&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen wvEzJeg by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;It’s neat when you start introducing things like &lt;code&gt;:has()&lt;/code&gt;. You could rotate the marker on open:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.select-menu:has(:open) svg&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;rotate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 180deg&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where could you take it next? What else do we need to make that a functioning &lt;code&gt;select&lt;/code&gt;? We&#39;ll save that for the next article. But don’t worry, styleable select elements are coming. Stay tuned!&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;thats-it&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/tether-elements-to-each-other-with-css-anchor-positioning/#thats-it&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; That’s it!&lt;/h3&gt;
&lt;p&gt;The web platform is evolving. CSS anchor positioning is a crucial part to improving how you develop UI controls. It will abstract you away from some of those tricky decisions. But it will also allow you to do things you&#39;ve never been able to do before. Such as styling a &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element! Let us know what you think.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Photo by &lt;a href=&quot;https://unsplash.com/@chuttersnap&quot;&gt;CHUTTERSNAP&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/photos/f2LYxnmnKxI&quot;&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Working with the industry to evolve CHIPS</title>
    <link href="https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/" />
    <updated>2023-02-28T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/</id>
    
      
      
      <author>
        <name>mihajlija</name>
      </author>
      
      
      <author>
        <name>jney</name>
      </author>
      
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/docs/privacy-sandbox/chips/&quot;&gt;Cookies Having Independent Partitioned State (CHIPS)&lt;/a&gt; is a Privacy Sandbox technology that allows developers to opt a cookie into &amp;quot;partitioned&amp;quot; storage, with separate cookie jars per top-level site.&lt;br /&gt;
Example use cases for CHIPS include any scenarios where cross-site subresources require some notion of session or persistent state that is scoped to a user&#39;s activity on a single top-level site, such as third-party chat widgets,  map embeds, subresource CDN load balancing, headless CMS providers, and more.&lt;/p&gt;
&lt;p&gt;CHIPS is being developed with the goal to become an open web standard. It is under discussion in the PrivacyCG and has had an origin trial for 7 months during which the Chrome team has received helpful feedback. During development the team worked with key stakeholders to explore that feedback, resulting in an updated design that better serves the web ecosystem.&lt;/p&gt;
&lt;p&gt;Let&#39;s explore two challenges that the Chrome team faced in implementing CHIPS and how community feedback played a key role in evolving the proposal design.&lt;/p&gt;
&lt;h2 id=&quot;removing-the-host-prefix-and-no-domain-requirement&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/#removing-the-host-prefix-and-no-domain-requirement&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Removing the host-prefix and no &lt;code&gt;Domain&lt;/code&gt; requirement&lt;/h2&gt;
&lt;p&gt;To encourage good security practices, CHIPS design requires that cookies only be set by and sent over secure protocols and that partitioned cookies must be set with &lt;code&gt;Secure&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Along with these requirements, the initial proposal disallowed the &lt;code&gt;Domain&lt;/code&gt; attribute on partitioned cookies. Omitting &lt;code&gt;Domain&lt;/code&gt; on cookies prevented sharing them between different third-party subdomains within a partition.&lt;/p&gt;
&lt;p&gt;During the origin trial, the Chrome team &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/30&quot;&gt;heard from partners and other stakeholders&lt;/a&gt; that the no-domain requirement made it difficult for sites with subdomains to implement CHIPS. For example, it would make it harder for &lt;code&gt;shop.example.com&lt;/code&gt; and &lt;code&gt;pay.example.com&lt;/code&gt; to share partitioned cookie jars. In other &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/39&quot;&gt;cases, it made authentication flows difficult in embedded contexts&lt;/a&gt;.&lt;/p&gt;
&lt;img alt=&quot;Diagram showing sites pay.example.com and shop.example.com&quot; decoding=&quot;async&quot; height=&quot;224&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/P8OeJqoGqjW8oZLTWmr5.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;  
&lt;p&gt;The Chrome team evaluated this feedback and concluded that removing the no-domain requirement would not create privacy challenges, but it would improve usability. In response, the CHIPS product team opened a discussion on &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/43&quot;&gt;GitHub&lt;/a&gt;, inviting more feedback about removing this requirement. Several companies that were testing CHIPS responded and commented publicly about the importance of this change for their use case.&lt;/p&gt;
&lt;p&gt;Chrome took the feedback to the W3C&#39;s Privacy Community Group and presented the updated proposal–Firefox and Edge approved the change to and Safari didn&#39;t raise any concerns. The following day, the Chrome team updated &lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/kZRtetS8jsY/m/ppK4kDbqAwAJ?utm_medium=email&amp;amp;utm_source=footer&quot;&gt;Blink-Dev&lt;/a&gt; and presented the plan to remove the requirement on the &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/47&quot;&gt;CHIPS Github repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The CHIPS team initially proposed this requirement to guarantee that sites do not receive cross-site cookies from any malicious or compromised subdomains, and mitigate the possibility of using Domain cookies as a channel to leak data across subdomains.&lt;/p&gt;
&lt;p&gt;While this provided additional security benefits, &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/30&quot;&gt;Tableau highlighted&lt;/a&gt; that it presented challenges for the adoption of CHIPS because some current application architectures rely on sharing cookies between subdomains.&lt;/p&gt;
&lt;p&gt;After Chrome made this change, Tableau, the company behind the visual analytics platform now owned by Salesforce, &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/30#issuecomment-1104225686&quot;&gt;shared&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This removal of the naming change makes the requirement much more inline with the previous changes to add the &lt;code&gt;SameSite=None&lt;/code&gt; attribute and so a more &#39;known&#39; quantity. We appreciate Google hearing the feedback, looking through the implications, and making the change to help support easier transitions.&lt;/p&gt;
&lt;p&gt;&lt;cite&gt;Lee Graber, Software Engineering Architect, Tableau&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Through this process, CHIPS was made easier to implement for stakeholders while preserving privacy for users.&lt;/p&gt;
&lt;h2 id=&quot;moving-from-a-static-to-dynamic-cookie-limit&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/#moving-from-a-static-to-dynamic-cookie-limit&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Moving from a static to dynamic cookie limit&lt;/h2&gt;
&lt;p&gt;The other challenge in implementing CHIPS was the static cookie limit.&lt;br /&gt;
To prevent a large memory footprint for cookies, the initial design proposed a numeric limit of 10 cookies per-site per-partition.&lt;/p&gt;
&lt;p&gt;Akamai shared &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/48&quot;&gt;public feedback&lt;/a&gt; that the proposed limit for partitioned cookies may not be sufficient for services like CDNs that offer top-level domains to host their customers&#39; content (such as customer.cdn.xyz). For example, customer1.cdn.xyz and customer2.cdn.xyz could both deliver third-party content and they could each set several of their own cookies. If multiple customer sites like this are embedded on another website, they may hit the 10 cookies per partition limit.&lt;/p&gt;
&lt;p&gt;The Chrome team heard similar feedback in other forums, across partner meetings and W3C discussions, so they considered the best ways to solve the challenge that the cookie limit presented in these use cases.&lt;/p&gt;
&lt;figure&gt;
&lt;img alt=&quot;Diagram showing the maximum number of SameSite=None cookies a single domain has on clients&amp;#x27; machines&quot; decoding=&quot;async&quot; height=&quot;457&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/cLVE4czgWDZPY9lz1IcH.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Diagram showing the maximum number of SameSite=None cookies a single domain has on clients&#39; machines&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;After considering how to incorporate community feedback, Chrome presented an updated idea at &lt;a href=&quot;https://drive.google.com/file/d/1wSUfOb7BIjtmsO6TdxyBMmw3RUQqCtGa/view&quot;&gt;TPAC 2022&lt;/a&gt;, suggesting that CHIPS move from a &lt;em&gt;static&lt;/em&gt; 10 cookie limit to a _dynamic _10 kb limit based on memory. The analysis showed that this change should cover 99% of use cases on the web and would uphold the privacy principles that Chrome was trying to achieve (limiting too much information shared about users cross sites) while still maintaining key uses.&lt;/p&gt;
&lt;p&gt;Other browser vendors &lt;a href=&quot;https://github.com/privacycg/CHIPS/issues/48#issuecomment-1271611177&quot;&gt;weighed in&lt;/a&gt; saying that they agreed with the updated solution, which was important for ensuring CHIPS maintained cross-browser support in the PrivacyCG.&lt;/p&gt;
&lt;p&gt;As a result, Chrome &lt;a href=&quot;https://github.com/chromium/chromium/commit/8be338400e94964708796d2be6afe071233c0f6f&quot;&gt;adopted&lt;/a&gt; the new limit and incorporated the solution into the CHIPS design.&lt;/p&gt;
&lt;h2 id=&quot;working-with-the-industry&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/working-with-the-industry-to-evolve-chips/#working-with-the-industry&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Working with the industry&lt;/h2&gt;
&lt;p&gt;We&#39;ve heard from many partners throughout the development of CHIPS and working together has been vital in the effort to improve privacy on the web.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Akamai enjoys a cooperative relationship on several fronts with other industry leaders like Google. The feedback we provided in the case of the CHIPS program may seem like a minor detail, but the change will go a long way to ensuring minimal negative impact to good use cases while still achieving the end goal. Our respective organizations are working to make the internet faster and more secure in our own ways, and the entire internet is better off when we work together.&lt;/p&gt;
&lt;p&gt;&lt;cite&gt;Martin Meyer, Senior Architect at Akamai Technologies&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;CHIPS has shown that feedback from the ecosystem is essential for improving technologies in the Privacy Sandbox. Open web conversations in GitHub, W3C meetings, and ongoing engagement with the Chrome team directly contributed to changes that have now been rolled out in Chrome stable. The Chrome team is eager to hear this feedback across a range of proposals, and it makes a huge difference for how technologies are developed and rolled out on the web.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Prepare for Chrome&#39;s user‑agent reduction</title>
    <link href="https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/" />
    <updated>2023-02-27T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/</id>
    
      
      
      <author>
        <name>rowan_m</name>
      </author>
      
    
    <content type="html">&lt;p&gt;Starting in Chrome 110 (February 2023) we are gradually introducing a &lt;em&gt;fixed value for Android version and device model&lt;/em&gt;—the default value will always be &lt;code&gt;Android 10&lt;/code&gt; on a model &lt;code&gt;K&lt;/code&gt;.
If you rely on the user-agent to detect a visitor&#39;s operating system version, Android device model, or detailed browser version then you may need to take action—read on for the details.&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;
  &lt;iframe class=&quot;youtube__embed&quot; src=&quot;https://www.youtube.com/embed/ftDVCo8SFD4&quot; title=&quot;youtube embed&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; loading=&quot;lazy&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;The &lt;a href=&quot;https://developer.mozilla.org/docs/Web/HTTP/Headers/User-Agent&quot;&gt;user-agent&lt;/a&gt; is a string that provides information about the user&#39;s browser and their environment—like knowing that a visitor on your site is running Chrome version 110 on Android.
Your browser sends this in an HTTP header and makes it available via JavaScript.&lt;/p&gt;
&lt;p&gt;The problem with full user-agent string is that it shares detailed information about the browser by default &lt;em&gt;on every request&lt;/em&gt; which is a major factor in allowing cross-site tracking.
Our goal is to reduce the opportunities for passively collecting this data while providing APIs to allow you to actively access data when you need it.&lt;/p&gt;
&lt;h2 id=&quot;user-agent-reduction-so-far&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#user-agent-reduction-so-far&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; User-agent reduction so far&lt;/h2&gt;
&lt;p&gt;We have already started removing some of the user-agent data that&#39;s available by default, and replacing it with fixed values.&lt;/p&gt;
&lt;p&gt;From &lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/dcTStiBZVoQ/m/KyomPLOnAwAJ&quot;&gt;Chrome 101&lt;/a&gt; we replaced the minor version number with zeros, e.g. &lt;span style=&quot;font-family: monospace&quot;&gt;Chrome/101&lt;span style=&quot;background: #ef9a9a&quot;&gt;.3.2.1&lt;/span&gt;&lt;/span&gt; became &lt;span style=&quot;font-family: monospace&quot;&gt;Chrome/101&lt;span style=&quot;background: #a5d6a7&quot;&gt;.0.0.0&lt;/span&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;From &lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/kC-AeZ1fSdY/m/a_ICuXZRBQAJ&quot;&gt;Chrome 107&lt;/a&gt; we replaced the desktop operating system version and CPU information with a fixed value for the platform.&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;&lt;td&gt;Mac&lt;/td&gt;&lt;td&gt;➡&lt;/td&gt;&lt;td&gt;&lt;span style=&quot;font-family: monospace; background: #a5d6a7&quot;&gt;Macintosh; Intel Mac OS X 10_15_7&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;Windows&lt;/td&gt;&lt;td&gt;➡&lt;/td&gt;&lt;td&gt;&lt;span style=&quot;font-family: monospace; background: #a5d6a7&quot;&gt;Windows NT 10.0; Win64; x64&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;ChromeOS&lt;/td&gt;&lt;td&gt;➡&lt;/td&gt;&lt;td&gt;&lt;span style=&quot;font-family: monospace; background: #a5d6a7&quot;&gt;X11; CrOS x86_64 14541.0.0&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;Linux&lt;/td&gt;&lt;td&gt;➡&lt;/td&gt;&lt;td&gt;&lt;span style=&quot;font-family: monospace; background: #a5d6a7&quot;&gt;X11; Linux x86_64&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;h2 id=&quot;fixed-android-version-and-device-model-starting-from-chrome-110&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#fixed-android-version-and-device-model-starting-from-chrome-110&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Fixed Android version and device model starting from Chrome 110&lt;/h2&gt;
&lt;p&gt;Starting in &lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/zVOEHwgyyu4/m/8KljdSN9AQAJ&quot;&gt;Chrome 110&lt;/a&gt; we are gradually introducing a &lt;em&gt;fixed value for Android version and device model&lt;/em&gt;.
Instead of seeing something like &lt;code&gt;Android 13&lt;/code&gt; on &lt;code&gt;Pixel 7&lt;/code&gt; the default value will &lt;em&gt;always be&lt;/em&gt; &lt;code&gt;Android 10&lt;/code&gt; on a model &lt;code&gt;K&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;compare pad-left-300&quot; data-type=&quot;worse&quot;&gt;
&lt;p class=&quot;compare__label pad-bottom-200&quot;&gt;
  Before: user-agent includes Android version and device model
&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-family: monospace&quot;&gt;Mozilla/5.0 (Linux; Android &lt;span style=&quot;background: #ef9a9a; font-weight: bold&quot;&gt;13&lt;/span&gt;; &lt;span style=&quot;background: #ef9a9a; font-weight: bold&quot;&gt;Pixel 7&lt;/span&gt;) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.0.0 Mobile Safari/537.36&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;compare pad-left-300&quot; data-type=&quot;better&quot;&gt;
&lt;p class=&quot;compare__label pad-bottom-200&quot;&gt;
  After: reduced user-agent with fixed Android version and device model
&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-family: monospace&quot;&gt;Mozilla/5.0 (Linux; Android &lt;span style=&quot;background: #a5d6a7; font-weight: bold&quot;&gt;10&lt;/span&gt;; &lt;span style=&quot;background: #a5d6a7; font-weight: bold&quot;&gt;K&lt;/span&gt;) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.0.0 Mobile Safari/537.36&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;no-change-to-the-user-agent-format&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#no-change-to-the-user-agent-format&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; No change to the user-agent format&lt;/h2&gt;
&lt;p&gt;The user-agent reduction changes the &lt;em&gt;values&lt;/em&gt; returned in the user-agent, but the &lt;em&gt;format&lt;/em&gt; stays the same.
If you only use the user-agent to read the operating system type or major browser version, that data will continue to update as before and you &lt;em&gt;do not need to take any action&lt;/em&gt;.&lt;/p&gt;
&lt;img alt=&quot;The platform, browser name, browser major version, and mobile indicator parts of the user-agent string continue to update as before. Operating system type, device model, and browser minor version are static values. All other portions of the user-agent string remain as is.&quot; decoding=&quot;async&quot; height=&quot;317&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/VWw0b3pM7jdugTkwI6Y81n6f5Yc2/GXIXCnvSXvaL7MZmHXgw.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;alternatives-to-user-agent&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#alternatives-to-user-agent&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Alternatives to user-agent&lt;/h2&gt;
&lt;p&gt;If you do currently use the more detailed data, it&#39;s always good to check if you can &lt;a href=&quot;https://developer.mozilla.org/docs/Web/HTTP/Browser_detection_using_the_user_agent&quot;&gt;use progressive enhancement or feature detection&lt;/a&gt; instead.&lt;/p&gt;
&lt;p&gt;Always remember that the user-agent is just like any other user-provided value—you should validate it and not assume it is accurate.
The user-agent value can be easily changed by the user, extensions, other clients—or may simply not be sent at all.
In most cases, you should be able to &lt;em&gt;deliver working content to visitors without user-agent data&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&quot;request-detailed-data-with-user-agent-client-hints&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#request-detailed-data-with-user-agent-client-hints&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Request detailed data with User-Agent Client Hints&lt;/h2&gt;
&lt;p&gt;There are plenty of valid reasons to access detailed user-agent data, such as providing device-specific content, anti-fraud functionality, or fine-grained logging.
If you do need the more detailed data, you can use the &lt;a href=&quot;https://developer.chrome.com/articles/user-agent-client-hints/&quot;&gt;User-Agent Client Hints (UA-CH)&lt;/a&gt; API to access it.
Like user-agent, UA-CH is available via HTTP headers or JavaScript.&lt;/p&gt;
&lt;p&gt;You may have already seen the default headers being sent with the &lt;code&gt;Sec-CH-UA-&lt;/code&gt; prefix that tells you the browser, its major version, the operating system, and if the browser is a mobile device.&lt;/p&gt;
&lt;p&gt;⏫ &lt;strong&gt;Default User-Agent Client Hints request headers from Chrome:&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Sec-CH-UA: &quot;Chromium&quot;;v=&quot;110&quot;, &quot;Not A(Brand&quot;;v=&quot;24&quot;, &quot;Google Chrome&quot;;v=&quot;110&quot;&lt;br /&gt;Sec-CH-UA-Mobile: ?1&lt;br /&gt;Sec-CH-UA-Platform: &quot;Android&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can use the &lt;code&gt;Accept-CH&lt;/code&gt; header in your response to ask for more data.
In this case, you can ask for &lt;code&gt;Sec-CH-UA-Platform-Version&lt;/code&gt; and &lt;code&gt;Sec-CH-UA-Model&lt;/code&gt; to get that Android version and device type back in subsequent requests.&lt;/p&gt;
&lt;p&gt;⏬ &lt;strong&gt;Response header from your server specifying platform version and model:&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Accept-CH:&lt;br /&gt;  Sec-CH-UA-Platform-Version,&lt;br /&gt;  Sec-CH-UA-Model&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;⏫ &lt;strong&gt;Request headers back from Chrome including Android version and model name:&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Sec-CH-UA-Platform-Version: &quot;13.0.0&quot;&lt;br /&gt;Sec-CH-UA-Model: &quot;Pixel 7&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can do the same thing in JavaScript by calling &lt;code&gt;getHighEntropyValues()&lt;/code&gt; on the &lt;code&gt;userAgentData&lt;/code&gt; API, passing in an array of the values you want: &lt;code&gt;platformVersion&lt;/code&gt; and &lt;code&gt;model&lt;/code&gt;.
This returns a promise with an object containing the specific values.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;userAgentData&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getHighEntropyValues&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;platformVersion&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;model&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;ua&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ua&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string-property property&quot;&gt;&quot;platformVersion&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;13.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string-property property&quot;&gt;&quot;model&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Pixel 7&quot;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;cross-origin-or-initial-requests&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#cross-origin-or-initial-requests&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Cross-origin or initial requests&lt;/h2&gt;
&lt;p&gt;If you have &lt;a href=&quot;https://web.dev/migrate-to-ua-ch/#strategy-delegating-hints-to-cross-origin-requests&quot;&gt;cross-origin resources on your page that need these values you can allow access&lt;/a&gt; via the &lt;code&gt;Permissions-Policy&lt;/code&gt; HTTP header or using the &lt;code&gt;Delegate-CH&lt;/code&gt; meta tag in your HTML.&lt;/p&gt;
&lt;p&gt;If it’s necessary for your site to have these sensitive values on the very first top-level request, you can use the &lt;a href=&quot;https://developer.chrome.com/docs/privacy-sandbox/user-agent/#critical-client-hints&quot;&gt;&lt;code&gt;Critical-CH&lt;/code&gt; HTTP header&lt;/a&gt; which will tell the browser to retry its initial request with those extra hints added.
This may be helpful for legacy systems that are hard to update, but ideally you should not be relying on these sensitive values to serve your initial HTML.&lt;/p&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;We started gradually introducing the fixed Android version and device in Chrome 110 from mid-February 2023,  to monitor for any potential ecosystem issues.
If you need more time to prepare,  &lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/2608710084154359809&quot;&gt;sign up for the deprecation trial&lt;/a&gt; so you can continue to &lt;em&gt;receive the legacy user-agent format&lt;/em&gt; until Chrome 113 (currently scheduled for the end of May 2023).&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;learn-more&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/user-agent-reduction-android-model-and-version/#learn-more&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Learn more&lt;/h2&gt;
&lt;p&gt;To see the reduced user-agent string in action, check out the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;See the reduced user-agent string for &lt;em&gt;your&lt;/em&gt; device on &lt;a href=&quot;https://goo.gle/reduced-ua-demo&quot;&gt;goo.gle/reduced-ua-demo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;See all the JavaScript and HTTP header User-Agent Client Hints for &lt;em&gt;your&lt;/em&gt; device on &lt;a href=&quot;https://goo.gle/ua-ch-demo&quot;&gt;goo.gle/ua-ch-demo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Send the reduced user-agent string in &lt;em&gt;your&lt;/em&gt; browser by enabling the &lt;code&gt;#reduce-user-agent&lt;/code&gt; &lt;a href=&quot;https://developer.chrome.com/docs/web-platform/chrome-flags/&quot;&gt;Chrome flag&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can also still &lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/-7123568710593282047&quot;&gt;register for the User Agent Reduction origin trial&lt;/a&gt; to receive the reduced user-agent on your site, although we will &lt;em&gt;end this trial in early March&lt;/em&gt; as we continue to ramp up sending the reduced user-agent by default.&lt;/p&gt;
&lt;p&gt;We have more resources on the &lt;a href=&quot;https://developer.chrome.com/docs/privacy-sandbox/user-agent/&quot;&gt;user-agent reduction landing page&lt;/a&gt; and you can also raise issues on our dedicated &lt;a href=&quot;https://goo.gle/ua-reduction-issues&quot;&gt;user-agent-reduction GitHub repo&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Improving standards of behavior in standards discussions</title>
    <link href="https://developer.chrome.com/en/blog/standards-behavior/" />
    <updated>2023-02-27T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/standards-behavior/</id>
    
      
      
      <author>
        <name>chriswilson</name>
      </author>
      
      
      <author>
        <name>jyasskin</name>
      </author>
      
    
    <content type="html">&lt;p&gt;One of the ongoing challenges in the web standards community is ensuring respectful, inclusive, and constructive conduct in standards discussions. We&#39;ve seen good technical discussions derailed when participants stop listening to each other; we&#39;ve also seen dominant voices shut out interest from newcomers who don&#39;t feel included.  Even among those of us who have been doing this for a long time, it is all too easy to answer bluntness with curt responses, and curt responses with rudeness; unfortunately, this escalates disagreements, and makes collaboration impossible. Several of us in the Chrome team set out to work with the community to develop some insights into how to improve. We hope to encourage the broad adoption of more respectful and productive interactions by setting a good example ourselves. We&#39;ve collected our guidance at &lt;a href=&quot;https://github.com/WebStandardsFuture/standards-of-behavior&quot;&gt;github.com/WebStandardsFuture/standards-of-behavior&lt;/a&gt;, and this post is a summary of that guidance.&lt;/p&gt;
&lt;p&gt;The standards-of-behavior document reflects not just our work but the feedback of the community. It has been co-signed by the leads of Chrome, and has received widely positive response from Googlers who work on standards. In addition, we have received positive feedback from representatives of other key organizations that participate in standards. We welcome you to comment (the &lt;a href=&quot;https://github.com/WebStandardsFuture/standards-of-behavior/issues&quot;&gt;github issue tracker&lt;/a&gt; is a good place to do that), and even to &lt;a href=&quot;https://github.com/WebStandardsFuture/standards-of-behavior#co-signed&quot;&gt;co-sign&lt;/a&gt; if you agree.&lt;/p&gt;
&lt;p&gt;We believe the development of successful, open standards for the web platform requires &lt;em&gt;safe, inclusive and productive&lt;/em&gt; venues for discussion. In particular, standards discourse must include and be respectful of diverse perspectives. Our interactions should always be respectful, professional, and constructive.  The continuing evolution of the web means new people join to contribute ideas all the time, and we want standards venues to be a place where not just old-timers and thick-skinned people can feel comfortable and be productive. Many of us have had to develop a thick skin to participate in the standards community. We have experienced discussions that have crossed the line from technical disagreements and debate into personal attacks. Dealing with this should not be part of standards work, and on open platforms, witnessing this type of behavior can prevent newcomers from contributing at all.&lt;/p&gt;
&lt;p&gt;These guidelines are not an attempt to rewrite Codes of Conduct in venues; we are saying that we expect organizations to enforce their Codes of Conduct, and participants to abide by them. We can have better, more inclusive outcomes for all if we improve the processes and interactions in standards groups.&lt;/p&gt;
&lt;p&gt;We want to be clear that this is a standard of behavior we (the Chrome team) expect of ourselves, as well as of others, in our interactions in standards venues. We welcome input in refining these expectations of behavior (by filing issues and participating in the &lt;a href=&quot;https://github.com/WebStandardsFuture/standards-of-behavior/discussions&quot;&gt;discussion&lt;/a&gt;), and we expect to call out violations of these expectations as counter-productive. We also expect Chrome team members to be called out if they are failing to meet these expectations.  Please email the web standards team ombuds (&lt;a href=&quot;mailto:web-standards-ombuds@google.com&quot;&gt;web-standards-ombuds@google.com&lt;/a&gt;) if our teammates aren&#39;t living up to our standards.&lt;/p&gt;
&lt;p&gt;A quick summary of our guidance is that we believe:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Standards discussions should adhere to standards organizations&#39; Codes of Conduct.&lt;/li&gt;
&lt;li&gt;Participants should follow some simple golden rules for standards discourse:
&lt;ul&gt;
&lt;li&gt;Be respectful, and recognize the validity of others&#39; points of view.&lt;/li&gt;
&lt;li&gt;Don&#39;t assume; ask for confirmation instead.&lt;/li&gt;
&lt;li&gt;Look for (and communicate) basic requirements, clear use cases and problem statements.&lt;/li&gt;
&lt;li&gt;Take actions that are constructive, and move towards consensus when possible.&lt;/li&gt;
&lt;li&gt;Take responsibility for your own words, work to reduce hostility, and be intentionally welcoming and inclusive.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In particular, we on the Chrome team will enforce these expectations for our own team members, and Chrome team members will be encouraged to exit discussions that persistently fail to adhere to these expectations. If violations persistently fail to be corrected, we will cease participation in the discussions until they are corrected.&lt;/p&gt;
&lt;p&gt;In short, we want to have more professional, respectful and inclusive discussions. Codes of conduct have not been consistently applied, and we should all expect them to be—we all have a responsibility to ensure safe, respectful venues. If any behaviors do not meet these standards, we plan to call them out, and we expect to be asked to improve in turn if we fail to live up to these standards.&lt;/p&gt;
&lt;p&gt;Again, if Googlers are failing to live up to these goals after being reminded of them, we want to hear about it and make it better. Please contact the web standards team ombuds (&lt;a href=&quot;mailto:web-standards-ombuds@google.com&quot;&gt;web-standards-ombuds@google.com&lt;/a&gt;), and we will help improve our collaboration.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Chris Wilson and Jeffrey Yasskin&lt;br /&gt;
Web Standards Tech Leads, Chrome Team&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Photo by &lt;a href=&quot;https://unsplash.com/@helloimnik?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText&quot;&gt;Nik&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Framework tools for font fallbacks</title>
    <link href="https://developer.chrome.com/en/blog/framework-tools-font-fallback/" />
    <updated>2023-02-27T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/framework-tools-font-fallback/</id>
    
      
      
      <author>
        <name>janicklasralphj</name>
      </author>
      
    
    <content type="html">&lt;p&gt;Sites that load fonts with &lt;em&gt;font-display: swap&lt;/em&gt; often suffer from a layout shift (&lt;a href=&quot;https://web.dev/cls/&quot;&gt;CLS&lt;/a&gt;) when the web font loads and is swapped with the fallback font.&lt;/p&gt;
&lt;p&gt;You can prevent CLS by adjusting the dimensions of the fallback font to match that of the primary font. Properties such as &lt;code&gt;size-adjust&lt;/code&gt;, &lt;code&gt;ascent-override&lt;/code&gt;, &lt;code&gt;descent-override&lt;/code&gt;, and &lt;code&gt;line-gap-override&lt;/code&gt; in the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@font-face&quot;&gt;&lt;code&gt;@font-face&lt;/code&gt;&lt;/a&gt; rule can help override the metrics of a fallback font allowing developers more control over how fonts are displayed. You can read more about font-fallbacks and the override properties in this &lt;a href=&quot;https://developer.chrome.com/blog/font-fallbacks/&quot;&gt;post&lt;/a&gt;. You can also see a working implementation of this technique in this &lt;a href=&quot;https://cultured-rightful-check.glitch.me/&quot;&gt;demo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This article explores how font size adjustments are implemented in the Next.js and Nuxt.js frameworks to generate the fallback font CSS and reduce the CLS. It also demonstrates how you can generate fallback fonts using cross-cutting tools such as Fontaine and Capsize.&lt;/p&gt;
&lt;h2 id=&quot;background&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#background&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Background&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;&lt;a href=&quot;https://developer.chrome.com/blog/font-display/#swap&quot;&gt;font-display: swap&lt;/a&gt;&lt;/em&gt; is generally used to prevent FOIT (Flash of invisible text) and to display contents faster on the screen. The value of &lt;code&gt;swap&lt;/code&gt; tells the browser that text using the font should be displayed immediately using a system font and to replace the system font only when the custom font is ready.&lt;/p&gt;
&lt;p&gt;The biggest issue with &lt;code&gt;swap&lt;/code&gt; is the jarring effect, where the difference in character sizes of the two fonts results in screen content shifting around. This leads to poor CLS scores, especially for text-heavy websites.&lt;/p&gt;
&lt;p&gt;The following images show an example of the issue. The first image uses &lt;code&gt;font-display: swap&lt;/code&gt; with no attempt to adjust the size of the fallback font. The second shows how adjusting the size using the CSS &lt;code&gt;@font-face&lt;/code&gt; rule improves the loading experience.&lt;/p&gt;
&lt;h3 id=&quot;without-adjusting-font-size&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#without-adjusting-font-size&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Without adjusting font size&lt;/h3&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Inter&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; serif&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img alt=&quot;Text that suddenly changes in font and size causing a jarring effect.&quot; decoding=&quot;async&quot; height=&quot;450&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 359px) 359px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=200 200w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=228 228w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=260 260w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=296 296w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=338 338w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=385 385w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=439 439w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=500 500w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=571 571w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=650 650w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AZ91M4LW9H8DzgOenxDB.gif?auto=format&amp;w=718 718w&quot; width=&quot;359&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;after-adjusting-font-size&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#after-adjusting-font-size&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; After adjusting font size&lt;/h3&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Inter&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fallback-inter&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; serif&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;fallback-inter&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 90.20%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 22.48%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;line-gap-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0.00%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 107.40%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img alt=&quot;Text that transitions smoothly to a different font.&quot; decoding=&quot;async&quot; height=&quot;450&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 359px) 359px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=200 200w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=228 228w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=260 260w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=296 296w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=338 338w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=385 385w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=439 439w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=500 500w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=571 571w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=650 650w, https://wd.imgix.net/image/IypihH3o5cSpEMVp5i08dp69otp2/AjGJB22nMK3WtqCIx7V0.gif?auto=format&amp;w=718 718w&quot; width=&quot;359&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Adjusting the size of the fallback font can be an effective strategy for preventing font loading layout shift, but implementing the logic from scratch can be tricky, as described in &lt;a href=&quot;https://developer.chrome.com/blog/font-fallbacks/&quot;&gt;this post about font fallbacks&lt;/a&gt;. Fortunately, several tooling options are already available to make this easier while developing apps.&lt;/p&gt;
&lt;h2 id=&quot;how-to-optimize-font-fallbacks-with-nextjs&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#how-to-optimize-font-fallbacks-with-nextjs&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; How to optimize font fallbacks with Next.js&lt;/h2&gt;
&lt;p&gt;Next.js provides a built-in way to enable fallback font optimization. This feature is enabled by default when you load fonts using the &lt;a href=&quot;https://nextjs.org/docs/api-reference/next/font&quot;&gt;@next/font&lt;/a&gt; component.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://nextjs.org/docs/api-reference/next/font&quot;&gt;@next/font&lt;/a&gt; component was introduced in Next.js version 13. The component provides an API to import Google Fonts or custom fonts into your pages and includes built-in automatic self-hosting of font files.&lt;/p&gt;
&lt;p&gt;When used, the fallback font metrics are automatically calculated and injected into the CSS file.&lt;/p&gt;
&lt;p&gt;​​For example, if you are using a Roboto font, you would typically define it in CSS as follows:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; swap&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 700&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Roboto&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To migrate to next/font:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Move the Roboto font declaration into your Javascript by importing the &#39;Roboto&#39; function from &#39;next/font&#39;. The function’s return value will be a class name you can leverage in your component template.
Remember to add &lt;code&gt;display: swap&lt;/code&gt; to the configuration object to enable the feature.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Roboto &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;@next/font/google&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; roboto &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Roboto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;400&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;subsets&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;latin&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;swap&#39;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Using display swap automatically enables the feature&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In your component, use the generated class name:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;RootLayout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; children &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ReactNode&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;html lang&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;en&quot;&lt;/span&gt; className&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;roboto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;body&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;html&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;The &lt;code&gt;next/font&lt;/code&gt; component is designed to support only ‘Arial’ and ‘Times New Roman’ as the fallback fonts. This choice was made mainly because of the universal support for Arial and Times New Roman fonts across platforms.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The &lt;a href=&quot;https://nextjs.org/docs/api-reference/next/font#adjustfontfallback&quot;&gt;adjustFontFallback&lt;/a&gt; config option:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For &lt;code&gt;@next/font/google&lt;/code&gt;:&lt;/strong&gt; A boolean value that sets whether an automatic fallback font should be used to reduce Cumulative Layout Shift. The default is true. Next.js automatically sets your fallback font to either &lt;code&gt;Arial&lt;/code&gt; or &lt;code&gt;Times New Roman&lt;/code&gt; depending on the font type (serif vs sans-serif respectively).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For &lt;code&gt;@next/font/local&lt;/code&gt;:&lt;/strong&gt; A string or boolean false value that sets whether an automatic fallback font should be used to reduce Cumulative Layout Shift. The possible values are &lt;code&gt;Arial&lt;/code&gt;, &lt;code&gt;Times New Roman&lt;/code&gt;, or &lt;code&gt;false&lt;/code&gt;. The default is &lt;code&gt;Arial&lt;/code&gt;. If you want to use a serif font, consider setting this value to &lt;code&gt;Times New Roman&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;another-option-for-google-fonts&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#another-option-for-google-fonts&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Another option for Google fonts&lt;/h3&gt;
&lt;p&gt;If using the &lt;code&gt;next/font&lt;/code&gt; component isn’t an option, another approach to use this feature with Google Fonts is via the &lt;code&gt;optimizeFonts&lt;/code&gt; flag. Next.js has the optimizeFonts feature already enabled by default. This feature inlines the Google Font CSS in the HTML response. Further, you can enable the font fallbacks adjustment feature by setting the &lt;code&gt;experimental.adjustFontFallbacksWithSizeAdjust&lt;/code&gt; flag in your next.config.js, as shown in the following snippet:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// In next.config.js&lt;/span&gt;&lt;br /&gt;module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token literal-property property&quot;&gt;experimental&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token literal-property property&quot;&gt;adjustFontFallbacksWithSizeAdjust&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: There is no plan to support this feature with the newly introduced &lt;code&gt;app&lt;/code&gt; dir. In the long term, it’s ideal to use &lt;code&gt;next/font&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;how-to-adjust-font-fallbacks-with-nuxt&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#how-to-adjust-font-fallbacks-with-nuxt&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; How to adjust font fallbacks with Nuxt&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/nuxt-modules/fontaine&quot;&gt;@nuxtjs/fontaine&lt;/a&gt; is a module for the Nuxt.js framework that automatically calculates the fallback font metric values and generates the fallback &lt;code&gt;@font-face&lt;/code&gt; CSS.&lt;/p&gt;
&lt;p&gt;Enable the module by adding &lt;code&gt;@nuxtjs/fontaine&lt;/code&gt; to your modules config:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; defineNuxtConfig &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;nuxt&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;defineNuxtConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;modules&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;@nuxtjs/fontaine&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you use Google Fonts or don&#39;t have a &lt;code&gt;@font-face&lt;/code&gt; declaration for a font, you can declare them as additional options.&lt;/p&gt;
&lt;p&gt;In most cases, the module can read the &lt;code&gt;@font-face&lt;/code&gt; rules from your CSS and automatically infer the details such as the font-family, fallback font family, and display type.&lt;/p&gt;
&lt;p&gt;If the font is defined in a place not discoverable by the module, you can pass the metrics info as shown in the following code snippet.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;defineNuxtConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;modules&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;@nuxtjs/fontaine&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;fontMetrics&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;fonts&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Inter&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;family&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Some Custom Font&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/path/to/custom/font.woff2&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The module automatically scans your CSS to read the @font-face declarations and generates the fallback @font-face rules.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; swap&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 700&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;/* This will be generated. */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;BlinkMacSystemFont&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Segoe UI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Noto Sans&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 92.7734375%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 24.4140625%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;line-gap-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can now use &lt;code&gt;Roboto override&lt;/code&gt; as the fallback font in your CSS, as shown in the following example&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* This becomes */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;generating-the-css-yourself&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#generating-the-css-yourself&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Generating the CSS yourself&lt;/h2&gt;
&lt;p&gt;Standalone libraries can also help you generate the CSS for fallback font size adjustments.&lt;/p&gt;
&lt;h3 id=&quot;using-fontaine-library&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#using-fontaine-library&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Using Fontaine library&lt;/h3&gt;
&lt;p&gt;If you are not using Nuxt or Next.js, you can use Fontaine. Fontaine is the underlying library powering &lt;a href=&quot;https://github.com/nuxt-modules/fontaine&quot;&gt;@nuxtjs/fontaine&lt;/a&gt;. You can use this library in your project to automatically inject fallback font CSS using Vite or Webpack plugins.&lt;/p&gt;
&lt;p&gt;Imagine you have a Roboto font defined in the CSS file:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; swap&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 700&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Fontaine provides &lt;a href=&quot;https://vitejs.dev/&quot;&gt;Vite&lt;/a&gt; and &lt;a href=&quot;https://webpack.js.org/&quot;&gt;Webpack&lt;/a&gt; transformers to plug into the build chain easily, enable the plugin as shown in the following JavaScript.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; FontaineTransform &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;fontaine&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; options &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;fallbacks&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;BlinkMacSystemFont&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Segoe UI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Noto Sans&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// You may need to resolve assets like `/fonts/Roboto.woff2` to a particular directory&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function-variable function&quot;&gt;resolvePath&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;file:///path/to/public/dir&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// overrideName: (originalName) =&gt; `${name} override`&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// sourcemap: false&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you&#39;re using Vite, add the plugin like this:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Vite&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;FontaineTransform&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;vite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If using Webpack, enable it as follows:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Webpack&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;FontaineTransform&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;webpack&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The module will automatically scan your files to modify the @font-face rules:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; swap&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;/fonts/Roboto.woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 700&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;/* This will be generated. */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;BlinkMacSystemFont&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Segoe UI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Noto Sans&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 92.7734375%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 24.4140625%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;line-gap-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can now use &lt;code&gt;Roboto override&lt;/code&gt; as your fallback font in CSS.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* This becomes */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Roboto override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;using-the-capsize-library&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#using-the-capsize-library&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Using the Capsize library&lt;/h3&gt;
&lt;p&gt;If you&#39;re not using Next.js, Nuxt, Webpack, or Vite, another option is to use the &lt;a href=&quot;https://seek-oss.github.io/capsize/&quot;&gt;Capsize library&lt;/a&gt; to generate the fallback CSS.&lt;/p&gt;
&lt;h4 id=&quot;new-createfontstack-api&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#new-createfontstack-api&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; New &lt;a href=&quot;https://github.com/seek-oss/capsize#createfontstack&quot;&gt;createFontStack&lt;/a&gt; api&lt;/h4&gt;
&lt;p&gt;The API is part of the &lt;a href=&quot;https://www.npmjs.com/package/@capsizecss/core&quot;&gt;@capsize/core&lt;/a&gt; package called &lt;code&gt;createFontStack&lt;/code&gt;, which accepts an array of font metrics in the same order as you would specify your font stack (the &lt;code&gt;font-family&lt;/code&gt; property).&lt;/p&gt;
&lt;p&gt;You can refer to the documentation on using Capsize &lt;a href=&quot;https://github.com/seek-oss/capsize#usage-1ontains%20the%20generated%20font%20face%20declarations%20as%20well%20as%20the%20computed%20fontFamily%20with%20the%20appropriately%20ordered%20font%20aliases.https://github.com/seek-oss/capsize#usage-1&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;example&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#example&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Example&lt;/h4&gt;
&lt;p&gt;Consider the following example: The desired web font is Lobster, falling back to Helvetica Neue and then Arial. In CSS, &lt;code&gt;font-family: Lobster, &#39;Helvetica Neue&#39;, Arial&lt;/code&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Import createFontStack from the core package:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; createFontStack &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;@capsizecss/core&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Import the font metrics for each of the desired fonts (see Font Metrics above):&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; lobster &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;@capsizecss/metrics/lobster&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; helveticaNeue &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;@capsizecss/metrics/helveticaNeue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; arial &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;@capsizecss/metrics/arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;`&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create your font stack, passing the metrics as an array, using the same order as you would via the font-family CSS property.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; fontFamily&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fontFaces &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createFontStack&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;br /&gt;  lobster&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  helveticaNeue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  arial&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This returns the following:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;fontFamily: Lobster, &#39;Lobster Fallback: Helvetica Neue&#39;, &#39;Lobster Fallback: Arial&#39;,&lt;br /&gt;  fontFaces: [&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;@font-face&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;font-family&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&quot;Lobster Fallback: Helvetica Neue&quot;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;ascent-override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;115.1741%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;descent-override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;28.7935%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;size-adjust&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;86.8251%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;@font-face&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token string&quot;&gt;&#39;font-family&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&quot;Lobster Fallback: Arial&quot;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token string&quot;&gt;&#39;ascent-override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 113.5679%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token string&quot;&gt;&#39;descent-override&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 28.392%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token string&quot;&gt;&#39;size-adjust&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 88.053%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt; ]&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You must add the fontFamily and fontFaces code to your CSS. The following code shows how to implement it in a CSS style sheet, or within a &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; block.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;text/css&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token style&quot;&gt;&lt;span class=&quot;token language-css&quot;&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.heading&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This will produce the following CSS:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.heading&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Lobster&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lobster Fallback: Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Lobster Fallback: Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lobster Fallback: Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Helvetica Neue&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 115.1741%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 28.7935%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 86.8251%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lobster Fallback: Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 113.5679%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 28.392%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 88.053%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can also use the &lt;a href=&quot;https://www.npmjs.com/package/@capsizecss/metrics&quot;&gt;@capsize/metrics&lt;/a&gt; package to calculate the override values, and apply them to the CSS yourself.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fontMetrics &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;@capsizecss/metrics/inter&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fallbackFontMetrics &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;@capsizecss/metrics/arial&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; mainFontAvgWidth &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xAvgWidth &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unitsPerEm&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fallbackFontAvgWidth &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fallbackFontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xAvgWidth &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; fallbackFontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unitsPerEm&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; sizeAdjust &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mainFontAvgWidth &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; fallbackFontAvgWidth&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; ascent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ascent &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unitsPerEm &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sizeAdjust&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; descent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;descent &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unitsPerEm &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sizeAdjust&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; lineGap &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lineGap &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unitsPerEm &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; fontMetrics&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sizeAdjust&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;acknowledgements&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/framework-tools-font-fallback/#acknowledgements&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Acknowledgements&lt;/h2&gt;
&lt;p&gt;Hero image by &lt;a href=&quot;https://unsplash.com/@alex_andrews&quot;&gt;Alexander Andrews&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Getting Started with Style Queries</title>
    <link href="https://developer.chrome.com/en/blog/style-queries/" />
    <updated>2023-02-24T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/style-queries/</id>
    
      
      
      <author>
        <name>unakravets</name>
      </author>
      
    
    <content type="html">&lt;p&gt;The ability to query a parent’s inline size, and container query unit values recently reached stable support in all &lt;a href=&quot;https://web.dev/cq-stable&quot;&gt;modern browser engines&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;wdi-browser-compat&quot;&gt;
  &lt;span class=&quot;wdi-browser-compat__label&quot;&gt;Browser support&lt;/span&gt;
  &lt;span class=&quot;wdi-browser-compat__items&quot;&gt;
    &lt;span class=&quot;wdi-browser-compat__icon&quot; data-browser=&quot;chrome&quot;&gt;
      &lt;span class=&quot;visually-hidden&quot;&gt;chrome 105, Supported&lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;wdi-browser-compat__version&quot; data-compat=&quot;yes&quot;&gt;105&lt;/span&gt;&lt;span class=&quot;wdi-browser-compat__icon&quot; data-browser=&quot;firefox&quot;&gt;
      &lt;span class=&quot;visually-hidden&quot;&gt;firefox 110, Supported&lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;wdi-browser-compat__version&quot; data-compat=&quot;yes&quot;&gt;110&lt;/span&gt;&lt;span class=&quot;wdi-browser-compat__icon&quot; data-browser=&quot;edge&quot;&gt;
      &lt;span class=&quot;visually-hidden&quot;&gt;edge 105, Supported&lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;wdi-browser-compat__version&quot; data-compat=&quot;yes&quot;&gt;105&lt;/span&gt;&lt;span class=&quot;wdi-browser-compat__icon&quot; data-browser=&quot;safari&quot;&gt;
      &lt;span class=&quot;visually-hidden&quot;&gt;safari 16, Supported&lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;wdi-browser-compat__version&quot; data-compat=&quot;yes&quot;&gt;16&lt;/span&gt;
  &lt;/span&gt;
  &lt;a class=&quot;wdi-browser-compat__link&quot; href=&quot;https://developer.mozilla.org/docs/Web/CSS/@container#browser_compatibility&quot; target=&quot;_blank&quot;&gt;Source&lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;However, the &lt;a href=&quot;https://www.w3.org/TR/css-contain-3/&quot;&gt;containment spec&lt;/a&gt; includes more than just size queries; it also enables querying a parent&#39;s style values. From Chromium 111, you’ll be able to apply style containment for custom property values and query a parent element for the value of a custom property.&lt;/p&gt;
&lt;p&gt;This means that we have even more logical control of styles in CSS, and enables  better separation of an application’s logic and data layer from its styles.&lt;/p&gt;
&lt;p&gt;The CSS Containment Module Level 3 spec, which covers size and style queries, allows for any styles to be queried from a parent, including property and value pairs such as &lt;code&gt;font-weight: 800&lt;/code&gt;. However, in the rollout of this feature, style queries currently only work with CSS custom property values. This is still very useful for combining styles and separating data from design. Let’s take a look at how you use style queries with CSS custom properties:&lt;/p&gt;
&lt;h2 id=&quot;getting-started-with-style-queries&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#getting-started-with-style-queries&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Getting started with style queries&lt;/h2&gt;
&lt;p&gt;Say we have the following HTML:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;ul&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;card-list&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;card-container&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;card&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      ...&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;card&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;ul&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To use style queries, you must first set up a container element. This requires a slightly different approach dependent on if you are querying a direct or indirect parent.&lt;/p&gt;
&lt;h3 id=&quot;querying-direct-parents&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#querying-direct-parents&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Querying direct parents&lt;/h3&gt;
&lt;img alt=&quot;Diagram of a style query.&quot; decoding=&quot;async&quot; height=&quot;549&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/GY3AdNySYRu6knWtPbTs.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Unlike with style queries, you don’t need to apply containment using the &lt;code&gt;container-type&lt;/code&gt; or &lt;code&gt;container&lt;/code&gt; property to &lt;code&gt;.card-container&lt;/code&gt; in order for &lt;code&gt;.card&lt;/code&gt; to be able to query the styles of its direct parent. However, we do need to apply the styles (custom property values in this case) to a container (&lt;code&gt;.card-container&lt;/code&gt; in this case) or any element &lt;em&gt;containing&lt;/em&gt; the element we’re styling in the DOM. We can’t apply styles we’re querying on the direct element we’re styling using that query because this could cause infinite loops.&lt;/p&gt;
&lt;p&gt;To directly query a parent, you can write:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* styling .card based on the value of --theme on .card-container */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--theme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; warm&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.card&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; wheat&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; brown&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You may have noticed that the style query wraps the query with  &lt;code&gt;style()&lt;/code&gt;. This is to disambiguate size values from styles. For example, you can write a query for the width of the container as &lt;code&gt;@container (min-width: 200px) { … }&lt;/code&gt;. This would apply styles if the parent container was at least 200px wide. However, &lt;code&gt;min-width&lt;/code&gt; can also be a CSS property, and you could query for the CSS value of &lt;code&gt;min-width&lt;/code&gt; using style queries. That’s why you’d use the &lt;code&gt;style()&lt;/code&gt; wrapper to make the difference clear: &lt;code&gt;@container style(min-width: 200px) { … }&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;styling-non-direct-parents&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#styling-non-direct-parents&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Styling non-direct parents&lt;/h3&gt;
&lt;p&gt;If you want to query styles for any element that isn’t a direct parent, you need to give that element a &lt;code&gt;container-name&lt;/code&gt;. For example, we can apply styles to &lt;code&gt;.card&lt;/code&gt; based on the styles of &lt;code&gt;.card-list&lt;/code&gt; by giving &lt;code&gt;.card-list&lt;/code&gt; a &lt;code&gt;container-name&lt;/code&gt;, and referencing it in the style query.&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* styling .card based on the value of --moreGlobalVar on .card-list */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; cards &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--moreGlobalVar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.card&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It’s generally a best practice to give your containers names to make it clear what you are querying and unlock the ability to access those containers more easily. One example of where this comes in handy is if you want to style elements within &lt;code&gt;.card&lt;/code&gt; directly. Without a named container on &lt;code&gt;.card-container&lt;/code&gt;, they can’t query it directly.&lt;/p&gt;
&lt;p&gt;But all of this makes a lot more sense in practice. Let’s take a look at some examples:&lt;/p&gt;
&lt;h2 id=&quot;style-queries-in-action&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#style-queries-in-action&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Style queries in action&lt;/h2&gt;
&lt;img alt=&quot;Demo image with multiple product cards, some with ‘new’ or ‘low stock’ tags and the ‘low stock’ card with a red background.&quot; decoding=&quot;async&quot; height=&quot;355&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/oKtluVGgWpuYyEn8Zd6W.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Style queries are particularly useful when you either have a reusable component with multiple variations, or when you don’t have control over all of your styles but need to apply changes in certain cases. This example shows a set of product cards which share the same card component. Some product cards have additional details/notes such as “New” or “Low Stock”, triggered by a custom property named &lt;code&gt;--details&lt;/code&gt;. Additionally, if a product is in “Low Stock”, it gets a deep red border background. This type of information is likely server rendered, and can be applied to the cards through inline styles like so:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;product-list&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;product-card-container&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value css language-css&quot;&gt;&lt;span class=&quot;token property&quot;&gt;--detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;product-card&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;media&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;img&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;comment-block&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;meta&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;product-card-container&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value css language-css&quot;&gt;&lt;span class=&quot;token property&quot;&gt;--detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; low-stock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;product-card-container&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  ...&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Given this structured data, you can pass values to &lt;code&gt;--detail&lt;/code&gt;, and use this CSS custom property to apply the styles:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; new&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.comment-block&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.comment-block::after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;New&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid currentColor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; white&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; low-stock&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.comment-block&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.comment-block::after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Low Stock&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid currentColor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; white&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    ...&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.media-img&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 2px solid brickred&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div style=&quot;height: 650px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/zYJqXWg?height=650&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen zYJqXWg by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;The above code allows us to apply a chip for &lt;code&gt;--detail: low-stock&lt;/code&gt; and &lt;code&gt;--detail: new&lt;/code&gt;, but you may have noticed some redundancy in the code block. Currently, there’s no way to query for just the presence of &lt;code&gt;--detail&lt;/code&gt; with &lt;code&gt;@container style(--detail)&lt;/code&gt;, which would allow for better sharing of styles and less repetition. This capability is currently &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues/8127&quot;&gt;in discussion&lt;/a&gt; in the working group.&lt;/p&gt;
&lt;h3 id=&quot;weather-cards&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#weather-cards&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Weather cards&lt;/h3&gt;
&lt;p&gt;The previous example used a single custom property with multiple possible values to apply styles. But you can mix it up by using and querying for multiple custom properties too. Take this weather card example:&lt;/p&gt;
&lt;img alt=&quot;Weather cards demo.&quot; decoding=&quot;async&quot; height=&quot;255&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/HodOHWjMnbNw56hvNASHWSgZyAf2/VCk15tNjkP3Emrrw2Xkl.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;To style the background gradients and icons for these cards, look for weather characteristics, such as “cloudy”, “rainy”, or “sunny”:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--sunny&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; true&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.weather-card&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;linear-gradient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-30deg&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; yellow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; orange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.weather-card:after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&amp;lt;data-uri-for-demo-brevity&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; gold&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This way, you can style each card based on its unique characteristics. But you can also style for characteristic (custom property) combinations, using the &lt;code&gt;and&lt;/code&gt; combinator in the same way as for &lt;a href=&quot;https://developer.mozilla.org//docs/Web/CSS/Media_Queries/Using_media_queries#combining_multiple_types_or_features&quot;&gt;media queries&lt;/a&gt;. For example, a day that is both cloudy and sunny would look like:&lt;/p&gt;
&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@container&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--sunny&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; true&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;--cloudy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; true&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token selector&quot;&gt;.weather-card&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;linear-gradient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;24deg&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pink&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; violet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.weather-card:after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&amp;lt;data-uri-for-demo-brevity&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; violet&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div style=&quot;height: 550px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/KKxzYQx?height=550&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen KKxzYQx by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;What would be even more useful for style container queries would be the ability to query range values. For example, you would be able to send data such as &lt;code&gt;--chanceOfRain: 50%&lt;/code&gt;, and then use a range, such as &lt;code&gt;@container style(30% &amp;lt;= --chanceOfRain &amp;lt; 60%)&lt;/code&gt; to apply the styles, This way, you could get a lot more granular with the design and its various combinations. This is another feature that is actively &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues/8376&quot;&gt;being discussed&lt;/a&gt; in the working group for container queries.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;separating-data-from-design&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/blog/style-queries/#separating-data-from-design&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Separating data from design&lt;/h2&gt;
&lt;p&gt;In both of these demos, there’s a structural benefit of separating the data layer (DOM that would be rendered on the page) from the styles applied. The styles are written as possible variants that live within the components style, while an endpoint could send the data that it would then use to style the component by. You can use a single value, such as in the first case, updating the &lt;code&gt;--detail&lt;/code&gt; value, or multiple variables, such as in the second case (setting either &lt;code&gt;--rainy&lt;/code&gt; or &lt;code&gt;--cloudy&lt;/code&gt; or &lt;code&gt;--sunny&lt;/code&gt;. And the best part is that you can combine these values as well, checking for both &lt;code&gt;--sunny&lt;/code&gt; and &lt;code&gt;--cloudy&lt;/code&gt; could show a partly cloudy style.&lt;/p&gt;
&lt;p&gt;Updating custom property values through JavaScript can be done seamlessly, either while setting up the DOM model (i.e. while building the component in a framework), or updated at any time using &lt;code&gt;&amp;lt;parentElem&amp;gt;.style.setProperty(&#39;--myProperty’, &amp;lt;value&amp;gt;)&lt;/code&gt;. I&lt;/p&gt;
&lt;p&gt;Here’s a demo that in a few lines of code, updates the &lt;code&gt;--theme&lt;/code&gt; of a button, and applies styles using style queries and that custom property (&lt;code&gt;--theme&lt;/code&gt;):&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; controls=&quot;&quot; height=&quot;243&quot; loop=&quot;&quot; muted=&quot;&quot; width=&quot;800&quot; style=&quot;--vid-width: 800; --vid-height: 243&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/HodOHWjMnbNw56hvNASHWSgZyAf2/mxE8At7l4Ii0O8meY5Zo.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;div style=&quot;height: 350px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/GRXZLvW?height=350&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen GRXZLvW by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;Style the card using style queries, the JavaScript used to update the custom property values is:&lt;/p&gt;
&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; themePicker &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;#theme-picker&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; btnParent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.btn-section&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;themePicker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;input&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  btnParent&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;style&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;--theme&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The features detailed in this article are just the start. You can expect more things from container queries to help you build dynamic, responsive interfaces. As for style queries specifically, there are still a few open issues. One is the implementation of style queries for CSS styles beyond custom properties. This is already a part of the current spec level, but not yet implemented in any browsers. The boolean context evaluation is expected to be added to the current spec level when the outstanding &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues/8127&quot;&gt;issue&lt;/a&gt; is resolved, while &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues/8376&quot;&gt;range querying&lt;/a&gt; is planned for the next level of the spec.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>DevTools Tips: Discover CSS issues
</title>
    <link href="https://developer.chrome.com/en/blog/devtools-tips-20/" />
    <updated>2023-02-23T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/blog/devtools-tips-20/</id>
    
      
      
      <author>
        <name>sofiayem</name>
      </author>
      
    
    <content type="html">&lt;p&gt;Have you ever applied CSS to an element but it just doesn&#39;t work?&lt;/p&gt;
&lt;p&gt;With Chrome DevTools, you can discover CSS issues at a glance, debug, and test them.&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;
  &lt;iframe class=&quot;youtube__embed&quot; src=&quot;https://www.youtube.com/embed/iuZx0kHS0Xs&quot; title=&quot;youtube embed&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; loading=&quot;lazy&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;Watch the video to learn how the &lt;strong&gt;Elements&lt;/strong&gt; &amp;gt; &lt;strong&gt;Styles&lt;/strong&gt; pane highlights various CSS issues:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;img alt=&quot;Warning.&quot; decoding=&quot;async&quot; height=&quot;24&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 26px) 26px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=26 26w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=30 30w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=34 34w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=39 39w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=44 44w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=50 50w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/jmGK9ty59IimtzofYo64.png?auto=format&amp;w=52 52w&quot; width=&quot;26&quot; /&gt; &lt;s&gt;Property with invalid syntax&lt;/s&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; &lt;s&gt;Overridden property&lt;/s&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span style=&quot;opacity:0.5&quot;&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; Inactive property &lt;img alt=&quot;Information.&quot; decoding=&quot;async&quot; height=&quot;20&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/2OyGRodvgk9neTIEAH4g.svg&quot; width=&quot;20&quot; /&gt;&lt;img alt=&quot;With a hint.&quot; decoding=&quot;async&quot; height=&quot;20&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 80px) 80px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=80 80w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=91 91w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=104 104w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=119 119w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=135 135w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=154 154w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/xWgVEhCcJCewCZMPA40M.png?auto=format&amp;w=160 160w&quot; width=&quot;80&quot; /&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span style=&quot;background-color: #e9ebed;display: block;&quot;&gt;Inherited from &lt;code&gt;parent&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; Inherited property&lt;/li&gt;
&lt;li&gt;&lt;span style=&quot;opacity:0.5&quot;&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; Non-inherited property&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; Expandable shorthand property &lt;img alt=&quot;Expand.&quot; decoding=&quot;async&quot; height=&quot;16&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 20px) 20px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=20 20w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=23 23w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=26 26w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=30 30w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=34 34w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=39 39w, https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/EFQ1zrhFIERbYg3nkEdG.png?auto=format&amp;w=40 40w&quot; width=&quot;20&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span style=&quot;opacity:0.5&quot;&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; &lt;s&gt;Overridden longhand property&lt;/s&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style=&quot;opacity:0.5&quot;&gt;&lt;img alt=&quot;Checkbox.&quot; decoding=&quot;async&quot; height=&quot;22&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/hmp8j3HiLMCcqPArD9yt.svg&quot; width=&quot;22&quot; /&gt; Active longhand property&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span style=&quot;float:right; opacity: 0.5;&quot;&gt;&lt;em&gt;user agent stylesheet&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Non-editable property&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;s&gt;&lt;em&gt;Overridden non-editable property&lt;/em&gt;&lt;/s&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;More debugging tips:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use the filter in the &lt;strong&gt;Styles&lt;/strong&gt; pane to focus on the one property that interests you.&lt;/li&gt;
&lt;li&gt;Use the &lt;strong&gt;Computed&lt;/strong&gt; pane to see all the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/Cascade&quot;&gt;Cascade&lt;/a&gt; winners and their computed values.&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Computed&lt;/strong&gt; pane, expand a property and click a link to find its source in the &lt;strong&gt;Styles&lt;/strong&gt; pane.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To learn more about all the ways DevTools highlights CSS issues, see &lt;a href=&quot;https://developer.chrome.com/docs/devtools/css/issues/&quot;&gt;Find invalid, overridden, inactive, and other CSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To level up your CSS expertise, see &lt;a href=&quot;https://web.dev/learn/css/&quot;&gt;Learn CSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To learn how to create websites that look great and work well for everyone, see &lt;a href=&quot;https://web.dev/learn/design/&quot;&gt;Learn Responsive Design&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Chrome’s Headless mode gets an upgrade: introducing `--headless=new`</title>
    <link href="https://developer.chrome.com/en/articles/new-headless/" />
    <updated>2023-02-22T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/articles/new-headless/</id>
    
      
      
      <author>
        <name>mathiasbynens</name>
      </author>
      
      
      <author>
        <name>peterkvitek</name>
      </author>
      
    
    <content type="html">&lt;p&gt;Chrome’s Headless mode just got a whole lot better! This article presents an overview of recent engineering efforts to make Headless more useful for developers by bringing Headless closer to Chrome’s regular “headful” mode.&lt;/p&gt;
&lt;h2 id=&quot;background&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#background&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Background&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.chrome.com/blog/headless-chrome/&quot;&gt;Back in 2017&lt;/a&gt;, Chrome 59 introduced the so-called Headless mode, which lets you run the browser in an unattended environment without any visible UI. Essentially, running Chrome without chrome!&lt;/p&gt;
&lt;p&gt;Headless mode is a popular choice for browser automation through projects like &lt;a href=&quot;https://developer.chrome.com/docs/puppeteer/&quot;&gt;Puppeteer&lt;/a&gt; or &lt;a href=&quot;https://chromedriver.chromium.org/&quot;&gt;ChromeDriver&lt;/a&gt;. Here’s a minimal command-line example of using Headless mode to create a PDF file of a given URL:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt; --print-to-pdf https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;whats-new-in-headless&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#whats-new-in-headless&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; What’s new in Headless?&lt;/h2&gt;
&lt;p&gt;Before we dive into the recent Headless improvements, it’s important to understand how the “old” Headless worked. The command-line snippet we showed earlier uses the &lt;code&gt;--headless&lt;/code&gt; command-line flag, suggesting that Headless is just a mode of operation of the regular Chrome browser. Perhaps surprisingly, this wasn’t actually true. Technically, &lt;strong&gt;the old Headless was &lt;a href=&quot;https://source.chromium.org/chromium/chromium/src/+/main:headless/;drc=c67febd82ae3e18ac8db1397f4ccfa87b0da2ffc&quot;&gt;a separate, alternate browser implementation&lt;/a&gt;&lt;/strong&gt; that happened to be shipped as part of the same Chrome binary. It doesn’t share any of the Chrome browser code in &lt;a href=&quot;https://source.chromium.org/chromium/chromium/src/+/main:chrome/&quot;&gt;&lt;code&gt;//chrome&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As you might imagine, implementing and maintaining this separate Headless browser came with a lot of engineering overhead — but that wasn’t the only problem. Because Headless was a separate implementation, it had its own bugs and features that weren’t present in headful Chrome. This created a confusing situation where any automated browser test might pass in headful mode but fail in Headless mode, or vice versa — a major pain point for automation engineers. It also excluded any automated testing that relied on having a browser extension installed, for example. The same goes for any other browser-level functionality: unless Headless had its own, separate implementation of it, it wasn’t supported.&lt;/p&gt;
&lt;p&gt;In 2021, the Chrome team set out to solve this problem, and unify Headless and headful modes once and for all.&lt;/p&gt;
&lt;img alt=&quot;The new Chrome Headless is no longer a separate browser implementation, and now instead shares code with Chrome.&quot; decoding=&quot;async&quot; height=&quot;516&quot; loading=&quot;lazy&quot; src=&quot;https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/K9FXq7WkolxhfVmYCnAO.svg&quot; width=&quot;500&quot; /&gt;
&lt;p&gt;We’re excited to announce that the new Headless mode is now available in Chrome 112! In this mode, Chrome creates but doesn’t display any platform windows. All other functionality, existing and future, is available with no limitations.&lt;/p&gt;
&lt;h2 id=&quot;try-out-the-new-headless&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#try-out-the-new-headless&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Try out the new Headless&lt;/h2&gt;
&lt;p&gt;To try the new Headless mode, pass the &lt;code&gt;--headless=new&lt;/code&gt; command-line flag:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For now, the old Headless mode is still available via:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;old&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Currently, passing the &lt;code&gt;--headless&lt;/code&gt; command-line flag without an explicit value still activates the old Headless mode — but we plan to change this default to new Headless over time.&lt;/p&gt;
&lt;p&gt;We plan to completely remove the old Headless from the Chrome binary and stop supporting this mode in Puppeteer later this year. As part of this removal, we’ll make the old Headless available as a separate standalone binary for those users who can’t upgrade yet.&lt;/p&gt;
&lt;h3 id=&quot;new-headless-in-puppeteer&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#new-headless-in-puppeteer&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; New Headless in Puppeteer&lt;/h3&gt;
&lt;p&gt;To opt in to the new Headless mode in Puppeteer:&lt;/p&gt;
&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; puppeteer &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;puppeteer&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; puppeteer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;launch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token literal-property property&quot;&gt;headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;new&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// `headless: true` (default) enables old Headless;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// `headless: &#39;new&#39;` enables new Headless;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// `headless: false` enables “headful” mode.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;newPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://developer.chrome.com/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// …&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;new-headless-in-selenium-webdriver&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#new-headless-in-selenium-webdriver&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; New Headless in Selenium-WebDriver&lt;/h3&gt;
&lt;p&gt;To use the new Headless mode in Selenium-WebDriver:&lt;/p&gt;
&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; driver &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; env&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setChromeOptions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addArguments&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;--headless=new&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; driver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://developer.chrome.com/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// …&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; driver&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;quit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;See &lt;a href=&quot;https://www.selenium.dev/blog/2023/headless-is-going-away/#what-are-the-two-headless-modes&quot;&gt;the Selenium team’s blog post&lt;/a&gt; for more information, including examples using other language bindings.&lt;/p&gt;
&lt;h3 id=&quot;headless-specific-command-line-flags&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#headless-specific-command-line-flags&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Headless-specific command-line flags&lt;/h3&gt;
&lt;p&gt;The following command-line flags are available for the new Headless mode.&lt;/p&gt;
&lt;h4 id=&quot;-dump-dom&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#-dump-dom&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; &lt;code&gt;--dump-dom&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;--dump-dom&lt;/code&gt; flag prints the serialized DOM of the target page to stdout. Here’s an example:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --dump-dom https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that this is different from simply printing the HTML source code (which you might do with &lt;code&gt;curl&lt;/code&gt;). To bring you the output of &lt;code&gt;--dump-dom&lt;/code&gt;, Chrome first parses the HTML code into a DOM, executes any &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; that might alter the DOM, and then turns that DOM back into a serialized string of HTML.&lt;/p&gt;
&lt;h4 id=&quot;-screenshot&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#-screenshot&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; &lt;code&gt;--screenshot&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;--screenshot&lt;/code&gt; flag takes a screenshot of the target page and saves it as &lt;code&gt;screenshot.png&lt;/code&gt; in the current working directory. It’s especially useful in combination with the &lt;code&gt;--window-size&lt;/code&gt; flag. Here’s an example:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new &lt;span class=&quot;token parameter variable&quot;&gt;--screenshot&lt;/span&gt; --window-size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;412,892&lt;/span&gt; https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;-print-to-pdf&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#-print-to-pdf&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; &lt;code&gt;--print-to-pdf&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;--print-to-pdf&lt;/code&gt; flag saves the target page as a PDF named &lt;code&gt;output.pdf&lt;/code&gt; in the current working directory. Here’s an example:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --print-to-pdf https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Optionally, you can add the &lt;code&gt;--no-pdf-header-footer&lt;/code&gt; flag to omit the print header (with the current date and time) and footer (with the URL and the page number).&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --print-to-pdf --no-pdf-header-footer https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;The functionality behind the &lt;code&gt;--no-pdf-header-footer&lt;/code&gt; flag was previously available via the &lt;code&gt;--print-to-pdf-no-header&lt;/code&gt; flag. Depending on which Chrome version you’re using, you might need to fall back to the old flag name.&lt;/p&gt;
&lt;/div&gt;
&lt;h4 id=&quot;-timeout&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#-timeout&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; &lt;code&gt;--timeout&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;--timeout&lt;/code&gt; flag specifies the delay in milliseconds after which the page’s content is captured by &lt;code&gt;--dump-dom&lt;/code&gt;, &lt;code&gt;--screenshot&lt;/code&gt;, and &lt;code&gt;--print-to-pdf&lt;/code&gt;. When neither &lt;code&gt;--timeout&lt;/code&gt; nor &lt;code&gt;--virtual-time-budget&lt;/code&gt; (see below) are specified, the page content is captured as soon as the page is loaded.&lt;/p&gt;
&lt;p&gt;To illustrate its use, consider &lt;a href=&quot;https://mathiasbynens.be/demo/time&quot;&gt;this demo page which increments, logs, and displays a counter every second&lt;/a&gt; using &lt;code&gt;setTimeout(fn, 1000)&lt;/code&gt;. Here’s the relevant code:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;0&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script&quot;&gt;&lt;span class=&quot;token language-javascript&quot;&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; element &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;output&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; counter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    counter&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;counter&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; counter&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1_000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After one second, the page contains “1”; after two seconds, “2”, and so on. Here’s how you’d capture the page’s state after 5 seconds and save it as a PDF:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --print-to-pdf &lt;span class=&quot;token parameter variable&quot;&gt;--timeout&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; https://mathiasbynens.be/demo/time&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;--timeout=5000&lt;/code&gt; flag tells Chrome to wait for 5 seconds before printing the PDF. Thus, this process takes at least 5 seconds to run.&lt;/p&gt;
&lt;h4 id=&quot;-virtual-time-budget&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#-virtual-time-budget&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; &lt;code&gt;--virtual-time-budget&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;--virtual-time-budget&lt;/code&gt; enables time travel! Well, to some extent. Virtual Time acts as a “fast-forward” for any time-dependent code (for example, &lt;code&gt;setTimeout&lt;/code&gt;/&lt;code&gt;setInterval&lt;/code&gt;). It forces the browser to execute any of the page’s code as fast as possible while making the page believe that the time actually goes by.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--virtual-time-budget&lt;/code&gt; is most commonly used as a replacement for &lt;code&gt;--timeout&lt;/code&gt;, like this:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --print-to-pdf --virtual-time-budget&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; https://mathiasbynens.be/demo/time&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This produces the same result as the previous example with &lt;code&gt;--timeout&lt;/code&gt;. The difference is that, with &lt;code&gt;--virtual-time-budget&lt;/code&gt;, the process takes very little real time — just about the same time as if there was no timeout specified at all. The difference becomes more obvious with larger values:&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --print-to-pdf --virtual-time-budget&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42000&lt;/span&gt; https://mathiasbynens.be/demo/time&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With &lt;code&gt;--timeout=42000&lt;/code&gt;, it would take at least 42 seconds before the PDF gets printed. With &lt;code&gt;--virtual-time-budget=42000&lt;/code&gt;, it barely takes longer than the previous example.&lt;/p&gt;
&lt;h2 id=&quot;debugging&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#debugging&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Debugging&lt;/h2&gt;
&lt;p&gt;Because Chrome is effectively invisible in Headless mode, it might sound tricky to figure out what’s going on in case of issues. Luckily, it’s possible to debug Headless Chrome in a way that’s very similar to headful Chrome. The trick is to launch Chrome in Headless mode with the &lt;code&gt;--remote-debugging-port&lt;/code&gt; command-line flag.&lt;/p&gt;
&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chrome &lt;span class=&quot;token parameter variable&quot;&gt;--headless&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new --remote-debugging-port&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; https://developer.chrome.com/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This prints a unique WebSocket URL to stdout, for example:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;DevTools listening on ws://127.0.0.1:60926/devtools/browser/b4bd6eaa-b7c8-4319-8212-225097472fd9&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In a regular headful Chrome instance, we can then use &lt;a href=&quot;https://developer.chrome.com/docs/devtools/remote-debugging/&quot;&gt;Chrome DevTools remote debugging&lt;/a&gt; to connect to the Headless target and inspect it. To do so, go to &lt;code&gt;chrome://inspect&lt;/code&gt;, click the &lt;strong&gt;Configure…&lt;/strong&gt; button, and enter the IP address and port number from the WebSocket URL. In the above example, I entered &lt;code&gt;127.0.0.1:60926&lt;/code&gt;. Click &lt;strong&gt;Done&lt;/strong&gt; and you should see a Remote Target appear with all its tabs and other targets listed below. Click &lt;strong&gt;inspect&lt;/strong&gt; and you now have access to Chrome DevTools inspecting the remote Headless target, &lt;strong&gt;including a live view of the page&lt;/strong&gt;!&lt;/p&gt;
&lt;img alt=&quot;Chrome DevTools can inspect a remote Headless target page&quot; decoding=&quot;async&quot; height=&quot;515&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&quot; srcset=&quot;https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=200 200w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=228 228w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=260 260w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=296 296w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=338 338w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=385 385w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=439 439w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=500 500w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=571 571w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=650 650w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=741 741w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=845 845w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=964 964w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=1098 1098w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=1252 1252w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=1428 1428w, https://wd.imgix.net/image/ZQjEes3OsyYCDLE5837FjNRQ1Gw2/GDP1l2VF3lV67bxNzskn.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;This live view currently only implements touch events, similar to &lt;a href=&quot;https://developer.chrome.com/docs/devtools/device-mode/&quot;&gt;mobile device emulation in Chrome DevTools&lt;/a&gt;. If you’re interested in mouse events as well, star &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1410433&quot;&gt;Chromium issue #1410433&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;feedback&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/new-headless/#feedback&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Feedback&lt;/h2&gt;
&lt;p&gt;We look forward to hearing your feedback about the new Headless mode. If you run into any issues, please &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&quot;&gt;report them&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
  
  <entry>
    <title>Declarative Shadow DOM</title>
    <link href="https://developer.chrome.com/en/articles/declarative-shadow-dom/" />
    <updated>2023-02-17T00:00:00Z</updated>
    <id>https://developer.chrome.com/en/articles/declarative-shadow-dom/</id>
    
      
      
      <author>
        <name>developit</name>
      </author>
      
      
      <author>
        <name>masonfreed</name>
      </author>
      
    
    <content type="html">&lt;p&gt;Declarative Shadow DOM is a web platform feature, &lt;a href=&quot;https://github.com/whatwg/html/pull/5465&quot;&gt;currently in the standardization process&lt;/a&gt;.
It is enabled by default in Chrome version 111.&lt;/p&gt;
&lt;div class=&quot;aside aside--note&quot;&gt;
&lt;p&gt;Declarative Shadow DOM has been available since Chrome 90 and Edge 91, but it used an older non-standard attribute called
&lt;code&gt;shadowroot&lt;/code&gt; instead of the standardized &lt;code&gt;shadowrootmode&lt;/code&gt; attribute.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/shadowdom-v1/&quot;&gt;Shadow DOM&lt;/a&gt; is one of the three Web Components standards, rounded out by &lt;a href=&quot;https://developer.mozilla.org/docs/Web/Web_Components/Using_templates_and_slots&quot;&gt;HTML templates&lt;/a&gt;
and &lt;a href=&quot;https://developer.mozilla.org/docs/Web/Web_Components/Using_custom_elements&quot;&gt;Custom Elements&lt;/a&gt;. Shadow DOM provides
a way to scope CSS styles to a specific DOM subtree and isolate that subtree from the rest of the document. The &lt;code&gt;&amp;lt;slot&amp;gt;&lt;/code&gt; element
gives us a way to control where the children of a Custom Element should be inserted within its Shadow Tree. These features
combined enable a system for building self-contained, reusable components that integrate seamlessly into existing applications
just like a built-in HTML element.&lt;/p&gt;
&lt;p&gt;Until now, the only way to use Shadow DOM was to construct a shadow root using JavaScript:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; host &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;host&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; shadowRoot &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; host&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attachShadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token literal-property property&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;open&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&amp;lt;h1&gt;Hello Shadow DOM&amp;lt;/h1&gt;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;An imperative API like this works fine for client-side rendering: the same JavaScript modules that define our Custom Elements
also create their Shadow Roots and set their content. However, many web applications need to render content server-side or to
static HTML at build time. This can be an important part of delivering a reasonable experience to visitors who may not be capable
of running JavaScript.&lt;/p&gt;
&lt;p&gt;The justifications for &lt;a href=&quot;https://web.dev/rendering-on-the-web/&quot;&gt;Server-Side Rendering&lt;/a&gt; (SSR) vary from project to project. Some
websites must provide fully functional server-rendered HTML in order to meet accessibility guidelines, others choose to deliver a
baseline no-JavaScript experience as a way to guarantee good performance on slow connections or devices.&lt;/p&gt;
&lt;p&gt;Historically, it has been difficult to use Shadow DOM in combination with Server-Side Rendering because there was no built-in
way to express Shadow Roots in the server-generated HTML. There are also performance implications when attaching Shadow Roots to
DOM elements that have already been rendered without them. This can cause layout shifting after the page has loaded, or temporarily
show a flash of unstyled content (&amp;quot;FOUC&amp;quot;) while loading the Shadow Root&#39;s stylesheets.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mfreed7/declarative-shadow-dom/blob/master/README.md&quot;&gt;Declarative Shadow DOM&lt;/a&gt; (DSD) removes this limitation,
bringing Shadow DOM to the server.&lt;/p&gt;
&lt;h2 id=&quot;building-a-declarative-shadow-root&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#building-a-declarative-shadow-root&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Building a Declarative Shadow Root&lt;/h2&gt;
&lt;p&gt;A Declarative Shadow Root is a &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; element with a &lt;code&gt;shadowrootmode&lt;/code&gt; attribute:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;host-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;template&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;shadowrootmode&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;open&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;h2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Light content&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;h2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;host-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A template element with the &lt;code&gt;shadowrootmode&lt;/code&gt; attribute is detected by the HTML parser and immediately applied as the shadow
root of its parent element. Loading the pure HTML markup from the above sample results in the following DOM tree:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;host-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  #shadow-root (open)&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    ↳&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;h2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Light content&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;h2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;host-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This code sample is following the Chrome DevTools Elements panel&#39;s conventions for displaying Shadow DOM content. For example,
the ↳ character represents slotted Light DOM content.&lt;/p&gt;
&lt;p&gt;This gives us the benefits of Shadow DOM&#39;s encapsulation and slot projection in static HTML. No JavaScript is needed to produce
the entire tree, including the Shadow Root.&lt;/p&gt;
&lt;h2 id=&quot;component-hydration&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#component-hydration&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Component hydration&lt;/h2&gt;
&lt;p&gt;Declarative Shadow DOM can be used on its own as a way to encapsulate styles or customize child placement, but it&#39;s most
powerful when used with Custom Elements. Components built using Custom Elements get automatically upgraded from static HTML.
With the introduction of Declarative Shadow DOM, it&#39;s now possible for a Custom Element to have a shadow root before it gets
upgraded.&lt;/p&gt;
&lt;p&gt;A Custom Element being upgraded from HTML that includes a Declarative Shadow Root will already have that shadow root
attached. This means the element will have a shadowRoot property already available when it is instantiated, without
your code explicitly creating one. It&#39;s best to check &lt;code&gt;this.shadowRoot&lt;/code&gt; for any existing shadow root in your element&#39;s
constructor. If there is already a value, the HTML for this component includes a Declarative Shadow Root. If the value is
null, there was no Declarative Shadow Root present in the HTML or the browser doesn&#39;t support Declarative Shadow DOM.&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;-Formatted HTML-&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;menu-toggle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;template&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;shadowrootmode&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;open&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  Open Menu&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;menu-toggle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script&quot;&gt;&lt;span class=&quot;token language-javascript&quot;&gt;&lt;br /&gt;   &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MenuToggle&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLElement&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;       &lt;span class=&quot;token comment&quot;&gt;// Detect whether we have SSR content already:&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;// A Declarative Shadow Root exists!&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;// wire up event listeners, references, etc.:&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; button &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstElementChild&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;         button&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;click&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; toggle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;// A Declarative Shadow Root doesn&#39;t exist.&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;// Create a new shadow root and populate it:&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; shadow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attachShadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token literal-property property&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;open&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;         shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;button&gt;&amp;lt;slot&gt;&amp;lt;/slot&gt;&amp;lt;/button&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;         shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;click&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; toggle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;   customElements&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;menu-toggle&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MenuToggle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Custom Elements have been around for a while, and until now there was no reason to check for an existing shadow root before
creating one using &lt;code&gt;attachShadow()&lt;/code&gt;. Declarative Shadow DOM includes a small change that allows existing components to work
despite this: calling the &lt;code&gt;attachShadow()&lt;/code&gt; method on an element with an existing &lt;strong&gt;Declarative&lt;/strong&gt; Shadow Root will &lt;strong&gt;not&lt;/strong&gt;
throw an error. Instead, the Declarative Shadow Root is emptied and returned. This allows older components not built for
Declarative Shadow DOM to continue working, since declarative roots are preserved until an imperative replacement is created.&lt;/p&gt;
&lt;p&gt;For newly-created Custom Elements, a new &lt;a href=&quot;https://github.com/WICG/webcomponents/issues/871&quot;&gt;&lt;code&gt;ElementInternals.shadowRoot&lt;/code&gt;&lt;/a&gt;
property provides an explicit way to get a reference to an element&#39;s existing Declarative Shadow Root, both open and closed. This
can be used to check for and use any Declarative Shadow Root, while still falling back &lt;code&gt;toattachShadow()&lt;/code&gt; in cases where one was
not provided.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MenuToggle&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLElement&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; internals &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attachInternals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token comment&quot;&gt;// check for a Declarative Shadow Root:&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; shadow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; internals&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;// there wasn&#39;t one. create a new Shadow Root:&lt;/span&gt;&lt;br /&gt;         shadow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attachShadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;            &lt;span class=&quot;token literal-property property&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;open&#39;&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;         shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;button&gt;&amp;lt;slot&gt;&amp;lt;/slot&gt;&amp;lt;/button&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token comment&quot;&gt;// in either case, wire up our event listener:&lt;/span&gt;&lt;br /&gt;      shadow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;click&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; toggle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;customElements&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;menu-toggle&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MenuToggle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;one-shadow-per-root&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#one-shadow-per-root&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; One shadow per root&lt;/h2&gt;
&lt;p&gt;A Declarative Shadow Root is only associated with its parent element. This means shadow roots are always colocated with
their associated element. This design decision ensures shadow roots are streamable like the rest of an HTML document. It&#39;s
also convenient for authoring and generation, since adding a shadow root to an element does not require maintaining a registry
of existing shadow roots.&lt;/p&gt;
&lt;p&gt;The tradeoff of associating shadow roots with their parent element is that it is not possible for multiple elements to be initialized
from the same Declarative Shadow Root &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt;. However, this is unlikely to matter in most cases where Declarative Shadow DOM is
used, since the contents of each shadow root are seldom identical. While server-rendered HTML often contains repeated element structures,
their content generally differs–for example, slight variations in text, or attributes. Because the contents of a serialized Declarative
Shadow Root are entirely static, upgrading multiple elements from a single Declarative Shadow Root would only work if the elements
happened to be identical. Finally, the impact of repeated similar shadow roots on network transfer size is relatively small due to
the effects of compression.&lt;/p&gt;
&lt;p&gt;In the future, it might be possible to revisit shared shadow roots. If the DOM gains support for &lt;a href=&quot;https://github.com/WICG/webcomponents/blob/gh-pages/proposals/Template-Instantiation.md&quot;&gt;built-in templating&lt;/a&gt;,
Declarative Shadow Roots could be treated as templates that are instantiated in order to construct the shadow root for a given element.
The current Declarative Shadow DOM design allows for this possibility to exist in the future by limiting shadow root association to a
single element.&lt;/p&gt;
&lt;h2 id=&quot;streaming-is-cool&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#streaming-is-cool&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Streaming is cool&lt;/h2&gt;
&lt;p&gt;Associating Declarative Shadow Roots directly with their parent element simplifies the process of upgrading and attaching them to
that element. Declarative Shadow Roots are detected during HTML parsing, and attached immediately when their &lt;strong&gt;opening&lt;/strong&gt; &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt;
tag is encountered. Parsed HTML within the &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; is parsed directly into the shadow root, so it can be &amp;quot;streamed&amp;quot;: rendered as it is received.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;div id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;el&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;   el&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// null&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;template shadowrootmode&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;open&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; shadow realm &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;template&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;   el&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// ShadowRoot&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;div&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;parser-only&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#parser-only&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Parser-only&lt;/h2&gt;
&lt;p&gt;Declarative Shadow DOM is a feature of the HTML parser. This means that a Declarative Shadow Root will only be parsed and attached for &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt;
tags with a &lt;code&gt;shadowrootmode&lt;/code&gt; attribute that are present during HTML parsing. In other words, Declarative Shadow Roots can
be constructed during initial HTML parsing:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;some-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;template&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;shadowrootmode&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;open&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   shadow root content for some-element&lt;br /&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;some-element&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Setting the &lt;code&gt;shadowrootmode&lt;/code&gt; attribute of a &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; element does nothing, and the template remains an ordinary template
element:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; div &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;div&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; template &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;template&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;template&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;shadowrootmode&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;open&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// this does nothing&lt;/span&gt;&lt;br /&gt;div&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;template&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;div&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// null&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To avoid some important security considerations, Declarative Shadow Roots also can&#39;t be created using fragment parsing APIs
like &lt;code&gt;innerHTML&lt;/code&gt; or &lt;code&gt;insertAdjacentHTML()&lt;/code&gt;. The only way to parse HTML with Declarative Shadow Roots applied is to pass a
new &lt;code&gt;includeShadowRoots&lt;/code&gt; option to &lt;code&gt;DOMParser&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; html &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&lt;br /&gt;   &amp;lt;div&gt;&lt;br /&gt;     &amp;lt;template shadowrootmode=&quot;open&quot;&gt;&amp;lt;/template&gt;&lt;br /&gt;   &amp;lt;/div&gt;&lt;br /&gt; &lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; div &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;div&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; div&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; html&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// No shadow root here&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fragment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DOMParser&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parseFromString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;html&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;text/html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token literal-property property&quot;&gt;includeShadowRoots&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Shadow root here&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;server-rendering-with-style&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#server-rendering-with-style&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Server-rendering with style&lt;/h2&gt;
&lt;p&gt;Inline and external stylesheets are fully supported inside Declarative Shadow Roots using the standard &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; tags:&lt;/p&gt;
&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;nineties-button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;template&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;shadowrootmode&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;open&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token style&quot;&gt;&lt;span class=&quot;token language-css&quot;&gt;&lt;br /&gt;         &lt;span class=&quot;token selector&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; seagreen&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;      &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/comicsans.css&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;slot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   I&#39;m Blue&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;nineties-button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Styles specified this way are also highly optimized: if the same stylesheet is present in multiple Declarative Shadow Roots,
it is only loaded and parsed once. The browser uses a single backing &lt;code&gt;CSSStyleSheet&lt;/code&gt; that is shared by all of the shadow roots,
eliminating duplicate memory overhead.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/constructable-stylesheets/&quot;&gt;Constructable Stylesheets&lt;/a&gt; are not supported in Declarative Shadow DOM. This
is because there is currently no way to serialize constructable stylesheets in HTML, and no way to refer to them when
populating &lt;code&gt;adoptedStyleSheets&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;avoiding-the-flash-of-unstyled-content&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#avoiding-the-flash-of-unstyled-content&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Avoiding the flash of unstyled content&lt;/h2&gt;
&lt;p&gt;One potential issue in browsers that do not yet support Declarative Shadow DOM is avoiding &amp;quot;flash of unstyled content&amp;quot; (FOUC),
where the raw contents are shown for Custom Elements that have not yet been upgraded. Prior to Declarative Shadow DOM, one common technique
for avoiding FOUC was to apply a &lt;code&gt;display:none&lt;/code&gt; style rule to Custom Elements that haven&#39;t been loaded yet, since these have
not had their shadow root attached and populated. In this way, content is not displayed until it is &amp;quot;ready&amp;quot;:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; x&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;foo&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;not&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;defined&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token literal-property property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With the introduction of Declarative Shadow DOM, Custom Elements can be rendered or authored in HTML such that their shadow
content is in-place and ready before the client-side component implementation is loaded:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;foo&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;template shadowrootmode&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;open&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;h2 &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token literal-property property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; blue&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;h2&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;shadow content&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;h2&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;template&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;foo&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this case, the &lt;code&gt;display:none&lt;/code&gt; &amp;quot;FOUC&amp;quot; rule would prevent the declarative shadow root&#39;s content from showing. However,
removing that rule would cause browsers without Declarative Shadow DOM support to show incorrect or unstyled content until
the Declarative Shadow DOM &lt;a href=&quot;https://web.dev/declarative-shadow-dom/#polyfill&quot;&gt;polyfill&lt;/a&gt; loads and converts the shadow root
template into a real shadow root.&lt;/p&gt;
&lt;p&gt;Fortunately, this can be solved in CSS by modifying the FOUC style rule. In browsers that support Declarative Shadow DOM, the
&lt;code&gt;&amp;lt;template shadowrootmode&amp;gt;&lt;/code&gt; element is immediately converted into a shadow root, leaving no &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; element in the DOM
tree. Browsers that don&#39;t support Declarative Shadow DOM preserve the &lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; element, which we can use to prevent FOUC:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt; x&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;foo&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;not&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;defined&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; template&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;shadowrootmode&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token literal-property property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;style&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instead of hiding the not-yet-defined Custom Element, the revised &amp;quot;FOUC&amp;quot; rule hides its &lt;em&gt;children&lt;/em&gt; when they follow a
&lt;code&gt;&amp;lt;template shadowrootmode&amp;gt;&lt;/code&gt; element. Once the Custom Element is defined, the rule no longer matches. The rule is ignored
in browsers that support Declarative Shadow DOM because the &lt;code&gt;&amp;lt;template shadowrootmode&amp;gt;&lt;/code&gt; child is removed during HTML parsing.&lt;/p&gt;
&lt;h2 id=&quot;feature-detection-and-browser-support&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#feature-detection-and-browser-support&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Feature detection and browser support&lt;/h2&gt;
&lt;p&gt;Declarative Shadow DOM has been available since Chrome 90 and Edge 91, but it used an older non-standard attribute called
&lt;code&gt;shadowroot&lt;/code&gt; instead of the standardized &lt;code&gt;shadowrootmode&lt;/code&gt; attribute. The newer &lt;code&gt;shadowrootmode&lt;/code&gt; attribute and streaming
behavior is available in Chrome 111 and Edge Xyz.&lt;/p&gt;
&lt;p&gt;As a new web platform API, Declarative Shadow DOM does not yet have widespread support across all browsers. Browser support
can be detected by checking for the existence of a &lt;code&gt;shadowRootMode&lt;/code&gt; property on the prototype of &lt;code&gt;HTMLTemplateElement&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;supportsDeclarativeShadowDOM&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLTemplateElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;prototype&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hasOwnProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;shadowRootMode&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;polyfill&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#polyfill&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Polyfill&lt;/h2&gt;
&lt;p&gt;Building a simplified polyfill for Declarative Shadow DOM is relatively straightforward, since a polyfill doesn&#39;t need to
perfectly replicate the timing semantics or parser-only characteristics that a browser implementation concerns itself
with. To polyfill Declarative Shadow DOM, we can scan the DOM to find all &lt;code&gt;&amp;lt;template shadowrootmode&amp;gt;&lt;/code&gt; elements, then convert
them to attached Shadow Roots on their parent element. This process can be done once the document is ready, or triggered by
more specific events like Custom Element lifecycles.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;attachShadowRoots&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt; root&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;template[shadowrootmode]&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; mode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; template&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;shadowrootmode&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; shadowRoot &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; template&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parentNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attachShadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; mode &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;template&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   template&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token function&quot;&gt;attachShadowRoots&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shadowRoot&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;document&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;further-reading&quot; tabindex=&quot;-1&quot;&gt;&lt;a class=&quot;heading-link&quot; href=&quot;https://developer.chrome.com/en/articles/declarative-shadow-dom/#further-reading&quot; aria-hidden=&quot;true&quot;&gt;#&lt;/a&gt; Further reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://chromestatus.com/feature/5161240576393216&quot;&gt;Chromestatus for Streaming Declarative Shadow DOM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/whatwg/html/pull/5465&quot;&gt;HTML Spec Pull Request&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  
</feed>
